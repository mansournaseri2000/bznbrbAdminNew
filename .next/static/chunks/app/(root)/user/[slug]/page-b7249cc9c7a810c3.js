(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5524],{30392:function(e,t,r){Promise.resolve().then(r.bind(r,88141))},88141:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return Q}});var n=r(57437),s=r(2265),l=r(39343),a=r(16463),i=r(94963),o=r(76351),d=r(93191),u=r(25524),c=r(27918),x=r(66648),p=r(51537),h=r(96396),j=r(52892),g=r(72549),y=r(31072),v=r(1845),m=e=>{let{onClose:t,userId:r,data:s}=e,{mutate:a,isPending:i}=(0,u.useMutation)({mutationFn:async e=>(0,c.uz)(r,e),onSuccess:async e=>{!0===e.status?(f.invalidateQueries({queryKey:["user_info"]}),(0,y.ToastSuccess)("اطلاعات مورد نظر با موفقیت بروزرسانی شد"),t()):(0,y.ToastError)("لطفا دوباره امتحان نمایید")},onError:e=>{console.log(e)}});console.log("USER_DATA",s.userInfo);let{control:o,setValue:m,watch:b}=(0,l.cI)({defaultValues:{name:null==s?void 0:s.userInfo.name,last_name:null==s?void 0:s.userInfo.last_name,email:null==s?void 0:s.userInfo.email,birthday:null==s?void 0:s.userInfo.birthday,pic:null==s?void 0:s.userInfo.pic,gender:null==s?void 0:s.userInfo.gender,mobile:null==s?void 0:s.userInfo.mobile,status:null==s?void 0:s.userInfo.status}}),f=(0,d.useQueryClient)();return(0,n.jsxs)(h.rj,{width:"100%",gap:"5",style:{backgroundColor:v.K.gray[2]},children:[(0,n.jsx)(h.kC,{width:"100%",justify:"center",mt:"5",children:(0,n.jsx)(h.xu,{width:"120px",height:"120px",position:"relative",children:(0,n.jsx)(x.default,{src:b("pic")?"".concat("https://uploader.darkube.app/").concat(b("pic")):"",alt:"تصویر کاربر",fill:!0,style:{borderRadius:"100px",border:"1px solid ".concat(v.K.blue[9])}})})}),(0,n.jsxs)(h.rj,{columns:"2",gap:"5",px:"5",children:[(0,n.jsx)(l.Qr,{name:"name",control:o,render:e=>{let{field:t}=e;return(0,n.jsx)(h.nv,{...t,placeholder:"نام"})}}),(0,n.jsx)(l.Qr,{name:"last_name",control:o,render:e=>{let{field:t}=e;return(0,n.jsx)(h.nv,{...t,placeholder:"نام خانوادگی"})}}),(0,n.jsx)(l.Qr,{name:"gender",control:o,render:e=>{let{field:t}=e;return(0,n.jsx)(h.fp,{...t,placeholder:"جنسیت",size:"3",value:String(t.value),onValueChange:e=>{t.onChange(e)},children:p.Qd.map(e=>(0,n.jsx)(h.Ql,{value:e.value,children:e.name},e.id))})}}),(0,n.jsx)(l.Qr,{name:"birthday",control:o,render:e=>(0,n.jsx)(j.Z,{inputMode:"none",placeholder:"تاریخ تولد",value:e.field.value,onChangeValue:e=>{m("birthday",Number(new Date(e)))},style:{backgroundColor:v.K.gray[1]}})}),(0,n.jsx)(l.Qr,{name:"mobile",control:o,render:e=>{let{field:t}=e;return(0,n.jsx)(h.nv,{disabled:!0,...t,placeholder:"شماره تماس"})}}),(0,n.jsx)(l.Qr,{name:"email",control:o,render:e=>{let{field:t}=e;return(0,n.jsx)(h.nv,{...t,placeholder:"ایمیل"})}})]}),(0,n.jsx)(g.Z,{submitButtonText:"ثبت تغییرات",closeButtonText:"لغو و بازگشت",isLoading:i,onCloseButton:t,onSubmit:()=>a(b())})]})},b=r(33913),f=r(47964),C=r(77855),I=r(40722),D=e=>{let[t,r]=(0,s.useState)(!1),i=(0,a.useRouter)(),{control:d,reset:u,setValue:c}=(0,l.Gc)(),x=(0,a.useSearchParams)(),j=e=>x.get(e)||"",{data:y}=(0,o.useQuery)({queryKey:["constant"],queryFn:async()=>(0,b.iV)()}),v=()=>{r(!1)},m=()=>{u({page:1,limit:10,sortDate:"",targetDate:"",userId:e.userId,originCityId:"",originProvinceId:"",destinationCityId:"",destinationProvinceId:"",departureDateStart:"",departureDateEnd:"",returnDateStart:"",returnDateEnd:"",sort:""}),i.replace("/user/".concat(e.userId)),e.onSubmit(),r(!1)},D=e=>{switch(e){case 1:return c("sortDate","des"),c("targetDate","dep");case 2:return c("targetDate","dep"),c("sortDate","asc");case 3:return c("targetDate","ret"),c("sortDate","des");case 4:return c("targetDate","ret"),c("sortDate","asc")}};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(h.kC,{width:"100%",align:"center",justify:"between",children:[(0,n.jsx)(h.hU,{colorVariant:"BLUE",variant:"soft",type:"button",size:"4",onClick:()=>r(!0),children:(0,n.jsx)(I.wn,{})}),(0,n.jsx)(h.kC,{width:"240px",children:(0,n.jsx)(l.Qr,{name:"sort",control:d,render:t=>{let{field:r}=t;return(0,n.jsx)(h.fp,{size:"3",...r,placeholder:"مرتب سازی بر اساس",value:String(r.value||j("sort")),onValueChange:t=>{let n=p.gy.find(e=>e.id===Number(t));D(null==n?void 0:n.id),r.onChange(t),e.onSubmit()},children:p.gy.map(e=>(0,n.jsx)(h.Ql,{value:String(e.id),children:e.name},e.id))})}})})]}),(0,n.jsxs)(h.u_,{isOpen:t,onClose:()=>r(!1),children:[(0,n.jsx)(C.Z,{title:"فیلتر",icon:(0,n.jsx)(I.ol,{}),handleClose:()=>r(!1)}),(0,n.jsx)(f.Z,{province:(null==y?void 0:y.provinces)?y.provinces:[],onSubmit:e.onSubmit}),(0,n.jsx)(g.Z,{submitButtonText:"اعمال فیلتر ها",closeButtonText:"حذف فیلتر ها",onCloseButton:()=>m(),onSubmit:()=>v()})]})]})},k=r(12767),S=r(10504),E=r(21949),K=e=>{let{data:t}=e,r=(0,a.useRouter)();return(0,n.jsx)(k.iA,{columns:[{accessorKey:"index",header:"ردیف",cell:e=>(0,n.jsx)(h.xv,{...E.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:v.K.gray[11]},children:e.row.index+1})},{accessorKey:"sourceCityName",header:"مبدا",cell:e=>{let t=e.getValue();return(0,n.jsx)(h.xv,{...E.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:v.K.gray[11]},children:t||"-"})}},{accessorKey:"destinationCity",header:"مقصد",cell:e=>{let t=e.getValue();return(0,n.jsx)(h.xv,{...E.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:v.K.gray[11]},children:t||"-"})}},{accessorKey:"createAt",header:"تاریخ ساخت برنامه",cell:e=>{let t=e.getValue();return(0,n.jsx)(h.xv,{...E.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:v.K.gray[11]},children:t||"-"})}},{accessorKey:"departureDate",header:"تاریخ رفت",cell:e=>{let t=e.getValue();return(0,n.jsx)(h.xv,{...E.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:v.K.gray[11]},children:t?(0,S.l)(t):"-"})}},{accessorKey:"returnDate",header:"تاریخ بازگشت",cell:e=>{let t=e.getValue();return(0,n.jsx)(h.xv,{...E.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:v.K.gray[11]},children:t?(0,S.l)(t):"-"})}},{id:"details",cell:e=>{let{row:t}=e,s=t.original;return(0,n.jsx)(h.kC,{width:"100%",height:"100%",align:"center",justify:"center",children:(0,n.jsx)(h.zx,{variant:"surface",onClick:()=>{console.log("item",s),r.push("/plans/user-plan")},children:"..."})})}}],data:t})},w=r(29962),z=r(72051),N=r(51360),P=r(94881),O=r(86555),A=r(25231);function Q(e){let{params:t,searchParams:r}=e,{data:x,isLoading:p,isFetching:j}=(0,o.useQuery)({queryKey:["user_info"],queryFn:async()=>(0,c.bG)(k)}),{push:g}=(0,a.useRouter)(),[b,f]=(0,s.useState)(!1),k=Number(t.slug),S=(0,d.useQueryClient)(),Q=(0,l.cI)({defaultValues:{page:Number(r.page)||1,limit:Number(r.limit)||10,sortDate:r.sortDate?r.sortDate:"",userId:k,targetDate:r.targetDate?r.targetDate:"",originCityId:r.originCityId?Number(r.originCityId):"",originProvinceId:r.originProvinceId?Number(r.originProvinceId):"",destinationCityId:r.destinationCityId?Number(r.destinationCityId):"",destinationProvinceId:r.destinationProvinceId?Number(r.destinationProvinceId):"",departureDateStart:r.departureDateStart?Number(r.departureDateStart):"",departureDateEnd:r.departureDateEnd?Number(r.departureDateEnd):"",returnDateStart:r.returnDateStart?Number(r.returnDateStart):"",returnDateEnd:r.returnDateEnd?Number(r.returnDateEnd):"",sort:r.sort||""}}),{watch:T,setValue:_,handleSubmit:V}=Q;console.log("USER Data",x);let{data:Z,mutate:R,isPending:B}=(0,u.useMutation)({mutationFn:async e=>(0,c.gG)(e),onSuccess:async e=>{let t=Object.fromEntries(Object.entries(T()).filter(e=>{let[t,r]=e;return!("userId"===t||void 0===r||""===r||"none"===r||null===r||Array.isArray(r)&&0===r.length||Array.isArray(r)&&r.every(e=>""===e)||Array.isArray(r)&&r.every(e=>"none"===e))&&(!["departureDateStart","departureDateEnd","returnDateStart","returnDateEnd"].includes(t)||new Date(r).getTime())}));Object.keys(t).forEach(e=>{["departureDateStart","departureDateEnd","returnDateStart","returnDateEnd"].includes(e)&&(t[e]=new Date(t[e]).getTime())});let r=(0,A.X)(t);g("/user/".concat(k,"?").concat(r)),console.log("data",e)},onError:async e=>{console.log("OnError",e)}}),{mutate:F,isPending:q}=(0,u.useMutation)({mutationFn:async e=>(0,c.uz)(k,e),onSuccess:async e=>{!0===e.status?(S.invalidateQueries({queryKey:["user_info"]}),(0,y.ToastSuccess)("کاربر مورد نظر با موفقیت غیر فعال شد")):(0,y.ToastError)("لطفا دوباره امتحان نمایید")},onError:e=>{console.log(e)}});(0,s.useEffect)(()=>{R(T())},[]);let L=()=>{R(T()),console.log("run")},M=e=>{let{name:t,last_name:r,email:n,birthday:s,gender:l}=e;return{name:t,last_name:r,email:n,birthday:s,gender:l,status:!1}},U=e=>{let{name:t,last_name:r,email:n,birthday:s,gender:l}=e;return{name:t,last_name:r,email:n,birthday:s,gender:l,status:!0}};return(0,n.jsxs)(h.kC,{direction:"column",children:[(0,n.jsx)(w.default,{title:"اطلاعات کاربر",isNavigation:!0}),(0,n.jsx)(h.xu,{p:"24px 110px 40px 40px ",children:(0,n.jsx)(h.rj,{width:"100%",maxWidth:"1920px",mx:"auto",children:(0,n.jsx)(l.RV,{...Q,children:(0,n.jsxs)("form",{onSubmit:V(L),children:[(0,n.jsxs)(h.rj,{width:"100%",gapY:"5",children:[p||j?(0,n.jsx)(i.$j,{style:{marginInline:"auto",scale:2,marginBlock:"20px"}}):(0,n.jsx)(P.Z,{...null==x?void 0:x.userInfo,type:"USER",onDeActive:()=>{(null==x?void 0:x.userInfo)&&F(M(x.userInfo))},onActive:()=>{(null==x?void 0:x.userInfo)&&F(U(x.userInfo))},isLoading:q,onEditInfo:()=>f(!0)}),(0,n.jsx)(h.xv,{...E.p.title2,style:{color:v.K.gray[12]},children:"برنامه های کاربر"}),(0,n.jsx)(D,{onSubmit:()=>R(T()),userId:k}),B?(0,n.jsx)(i.$j,{style:{marginInline:"auto",scale:2,marginBlock:"20px"}}):(0,n.jsx)(K,{data:(null==Z?void 0:Z.latestTrips)?Z.latestTrips:[]}),(null==Z?void 0:Z.latestTrips)&&(0,n.jsxs)(h.kC,{width:"100%",align:"center",justify:"between",children:[(0,n.jsx)(z.Z,{current:T("page"),total:null==Z?void 0:Z.totalPages,onPageChange:e=>{_("page",e),(0,O.Z)(e),L()}}),(0,n.jsx)(N.Z,{data:null==Z?void 0:Z.latestTrips,currentPage:null==Z?void 0:Z.currentPage,totalCount:null==Z?void 0:Z.totalCount})]})]}),(0,n.jsxs)(h.u_,{isOpen:b,onClose:()=>f(!1),children:[(0,n.jsx)(C.Z,{title:"ویرایش کاربر",icon:(0,n.jsx)(I.x8,{}),handleClose:()=>f(!1)}),(0,n.jsx)(m,{onClose:()=>f(!1),userId:k,data:x})]})]})})})})]})}},94881:function(e,t,r){"use strict";var n=r(57437),s=r(2265),l=r(66648),a=r(94963),i=r(96396),o=r(40252),d=r(1845),u=r(21949),c=r(10504);t.Z=e=>{let{pic:t,name:r,last_name:p,birthday:h,gender:j,mobile:g,email:y,type:v,status:m,onShowProfile:b,onDeActive:f,onActive:C,onEditInfo:I,isLoading:D}=e,[k,S]=(0,s.useState)({isOpen:!1,key:"active"});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.default,{hero:"سازنده برنامه",children:(0,n.jsxs)(i.rj,{width:"100%",columns:"3",px:"4",gapX:"5",style:{gridTemplateColumns:"auto 3fr auto"},children:[(0,n.jsx)(i.xu,{width:"130px",height:"130px",position:"relative",children:(0,n.jsx)(l.default,{src:t?"".concat("https://uploader.darkube.app/").concat(t):"",alt:"تصویر کاربر",fill:!0,style:{borderRadius:"100px",border:"1px solid ".concat(d.K.blue[9])}})}),(0,n.jsxs)(i.rj,{width:"3",columns:"3",gapY:"5",children:[(0,n.jsx)(x,{label:"نام",value:r}),(0,n.jsx)(x,{label:"نام خانوادگی",value:p}),(0,n.jsx)(x,{label:"تاریخ تولد",value:(0,c.l)(h)}),(0,n.jsx)(x,{label:"جنسیت",value:"MALE"===j?"مرد":"زن"}),(0,n.jsx)(x,{label:"شماره تماس",value:g}),(0,n.jsx)(x,{label:"ایمیل",value:y})]}),(0,n.jsx)(i.kC,{align:"end",children:"PLAN"===v?(0,n.jsx)(i.zx,{size:"3",colorVariant:"PINK",onClick:b,children:(0,n.jsx)(i.xv,{...u.p.body1,children:"مشاهده پروفایل"})}):(0,n.jsxs)(i.kC,{direction:"column",gap:"2",children:[!0===m?(0,n.jsx)(i.zx,{size:"3",colorVariant:"PINK",type:"button",onClick:()=>S({isOpen:!0,key:"deActive"}),children:(0,n.jsx)(i.xv,{...u.p.body1,children:"غیرفعال کردن کاربر"})}):(0,n.jsx)(i.zx,{size:"3",type:"button",onClick:()=>S({isOpen:!0,key:"active"}),children:(0,n.jsx)(i.xv,{...u.p.body1,children:"فعال سازی کاربر"})}),(0,n.jsx)(i.zx,{size:"3",type:"button",onClick:I,children:(0,n.jsx)(i.xv,{...u.p.body1,children:"ویرایش اطلاعات"})})]})})]})}),(0,n.jsxs)(i.u_,{isOpen:k.isOpen,onClose:()=>S({...k,isOpen:!1}),children:["deActive"===k.key&&(0,n.jsxs)(i.rj,{gapY:"24px",p:"5",children:[(0,n.jsx)(i.xv,{children:"آیا از غیر فعال کردن این کاربر اظمینان دارید؟ "}),(0,n.jsxs)(i.rj,{gap:"10px",columns:"2",children:[(0,n.jsx)(i.zx,{onClick:()=>{f&&f(),S({...k,isOpen:!1})},variant:"soft",size:"4",children:(0,n.jsx)(i.xv,{...u.p.body3,children:D?(0,n.jsx)(a.$j,{}):"بله"})}),(0,n.jsx)(i.zx,{type:"button",onClick:()=>S({...k,isOpen:!1}),variant:"solid",size:"4",children:(0,n.jsx)(i.xv,{...u.p.body3,children:"خیر"})})]})]}),"active"===k.key&&(0,n.jsxs)(i.rj,{gapY:"24px",p:"5",children:[(0,n.jsx)(i.xv,{children:"آیا از فعال کردن این کاربر اظمینان دارید؟ "}),(0,n.jsxs)(i.rj,{gap:"10px",columns:"2",children:[(0,n.jsx)(i.zx,{onClick:()=>{C&&C(),S({...k,isOpen:!1})},variant:"soft",size:"4",children:(0,n.jsx)(i.xv,{...u.p.body3,children:D?(0,n.jsx)(a.$j,{}):"بله"})}),(0,n.jsx)(i.zx,{type:"button",onClick:()=>S({...k,isOpen:!1}),variant:"solid",size:"4",children:(0,n.jsx)(i.xv,{...u.p.body3,children:"خیر"})})]})]})]})]})};let x=e=>{let{label:t,value:r}=e;return(0,n.jsxs)(i.kC,{align:"center",gap:"2",children:[(0,n.jsx)(i.xv,{...u.p.body2,style:{color:d.K.gray[10]},children:t}),(0,n.jsx)(i.xv,{...u.p.body1,style:{color:d.K.gray[12]},children:r||"-"})]})}},40252:function(e,t,r){"use strict";var n=r(57437),s=r(2265),l=r(89183),a=r(96396),i=r(1845);let o=s.forwardRef((e,t)=>{let{hero:r,children:s,...l}=e;return(0,n.jsxs)(d,{ref:t,...l,children:[(0,n.jsx)(a.kC,{className:"style",p:"8px 16px",children:(0,n.jsx)(a.X6,{as:"h6",size:"6",style:{color:i.K.gray[1],fontWeight:700},children:r})}),(0,n.jsx)(a.rj,{gap:"16px",p:"24px 16px 16px 16px",children:s})]})});t.default=o;let d=(0,l.ZP)(a.rj).withConfig({componentId:"sc-3db28b84-0"})(["background-color:",";border-radius:8px;border:1px solid ",";min-height:100px;.style{border-top-right-radius:8px;border-top-left-radius:8px;height:fit-content;background-color:",";}"],i.K.gray[2],i.K.gray[6],i.K.blue[10])}},function(e){e.O(0,[1553,3048,3497,8334,5452,8310,6990,9212,9673,3348,4518,9269,6648,5639,6396,722,4011,7524,2971,7023,1744],function(){return e(e.s=30392)}),_N_E=e.O()}]);