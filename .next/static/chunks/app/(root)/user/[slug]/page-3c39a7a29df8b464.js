(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5524],{30392:function(e,r,t){Promise.resolve().then(t.bind(t,88141))},88141:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return A}});var n=t(57437),l=t(2265),s=t(39343),a=t(16463),i=t(94963),o=t(76351),d=t(25524),u=t(27918),c=t(93191),x=t(51537),h=t(96396),g=t(52892),p=t(72549),j=t(31072),y=t(1845),m=e=>{let{onClose:r,userId:t,data:l}=e,{mutate:a,isPending:i}=(0,d.useMutation)({mutationFn:async e=>(0,u.uz)(t,e),onSuccess:async e=>{!0===e.status?(b.invalidateQueries({queryKey:["user_info"]}),(0,j.ToastSuccess)("اطلاعات مورد نظر با موفقیت بروزرسانی شد"),r()):(0,j.ToastError)("لطفا دوباره امتحان نمایید")},onError:e=>{console.log(e)}});console.log("USER_DATA",l.userInfo);let{control:o,setValue:m,watch:v}=(0,s.cI)({defaultValues:{name:null==l?void 0:l.userInfo.name,last_name:null==l?void 0:l.userInfo.last_name,email:null==l?void 0:l.userInfo.email,birthday:null==l?void 0:l.userInfo.birthday,pic:null==l?void 0:l.userInfo.pic,gender:null==l?void 0:l.userInfo.gender,mobile:null==l?void 0:l.userInfo.mobile,status:null==l?void 0:l.userInfo.status}}),b=(0,c.useQueryClient)();return(0,n.jsxs)(h.rj,{width:"100%",gap:"5",style:{backgroundColor:y.K.gray[2]},children:[(0,n.jsx)(h.kC,{width:"100%",justify:"center",mt:"5",children:(0,n.jsx)(h.kC,{width:"120px",height:"120px",justify:"center",align:"center",style:{border:"1px solid gray",borderRadius:"100%"},children:(0,n.jsx)(h.xv,{children:"image picker"})})}),(0,n.jsxs)(h.rj,{columns:"2",gap:"5",px:"5",children:[(0,n.jsx)(s.Qr,{name:"name",control:o,render:e=>{let{field:r}=e;return(0,n.jsx)(h.nv,{...r,placeholder:"نام"})}}),(0,n.jsx)(s.Qr,{name:"last_name",control:o,render:e=>{let{field:r}=e;return(0,n.jsx)(h.nv,{...r,placeholder:"نام خانوادگی"})}}),(0,n.jsx)(s.Qr,{name:"gender",control:o,render:e=>{let{field:r}=e;return(0,n.jsx)(h.fp,{...r,placeholder:"جنسیت",size:"3",value:String(r.value),onValueChange:e=>{r.onChange(e)},children:x.Qd.map(e=>(0,n.jsx)(h.Ql,{value:e.value,children:e.name},e.id))})}}),(0,n.jsx)(s.Qr,{name:"birthday",control:o,render:e=>(0,n.jsx)(g.Z,{inputMode:"none",placeholder:"تاریخ تولد",value:e.field.value,onChangeValue:e=>{m("birthday",Number(new Date(e)))}})}),(0,n.jsx)(s.Qr,{name:"mobile",control:o,render:e=>{let{field:r}=e;return(0,n.jsx)(h.nv,{...r,placeholder:"شماره تماس"})}}),(0,n.jsx)(s.Qr,{name:"email",control:o,render:e=>{let{field:r}=e;return(0,n.jsx)(h.nv,{...r,placeholder:"ایمیل"})}})]}),(0,n.jsx)(p.Z,{submitButtonText:"ثبت تغییرات",closeButtonText:"لغو و بازگشت",isLoading:i,onCloseButton:r,onSubmit:()=>a(v())})]})},v=t(33913),b=t(47964),f=t(77855),C=t(83882),I=e=>{let[r,t]=(0,l.useState)(!1),i=(0,a.useRouter)(),{control:d,reset:u,setValue:c}=(0,s.Gc)(),{data:g}=(0,o.useQuery)({queryKey:["constant"],queryFn:async()=>(0,v.iV)()}),j=()=>{t(!1)},y=()=>{u({page:1,limit:10,sortDate:"",targetDate:"",userId:"",originCityId:"",originProvinceId:"",destinationCityId:"",destinationProvinceId:"",departureDateStart:"",departureDateEnd:"",returnDateStart:"",returnDateEnd:"",sort:""}),i.replace("/user/".concat(e.userId)),t(!1)},m=e=>{switch(e){case 1:return c("sortDate","des"),c("targetDate","dep");case 2:return c("targetDate","dep"),c("sortDate","asc");case 3:return c("targetDate","ret"),c("sortDate","des");case 4:return c("targetDate","ret"),c("sortDate","asc")}};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(h.kC,{width:"100%",align:"center",justify:"between",children:[(0,n.jsx)(h.hU,{colorVariant:"BLUE",variant:"soft",size:"4",onClick:()=>t(!0),children:(0,n.jsx)(C.wn,{})}),(0,n.jsx)(h.kC,{width:"240px",children:(0,n.jsx)(s.Qr,{name:"sort",control:d,render:r=>{let{field:t}=r;return(0,n.jsx)(h.fp,{size:"3",...t,placeholder:"مرتب سازی بر اساس",value:String(t.value),onValueChange:r=>{let n=x.gy.find(e=>e.id===Number(r));m(null==n?void 0:n.id),t.onChange(r),e.onSubmit()},children:x.gy.map(e=>(0,n.jsx)(h.Ql,{value:String(e.id),children:e.name},e.id))})}})})]}),(0,n.jsxs)(h.u_,{isOpen:r,onClose:()=>t(!1),children:[(0,n.jsx)(f.Z,{title:"فیلتر",icon:(0,n.jsx)(C.ol,{}),handleClose:()=>t(!1)}),(0,n.jsx)(b.Z,{province:(null==g?void 0:g.provinces)?g.provinces:[]}),(0,n.jsx)(p.Z,{submitButtonText:"اعمال فیلتر ها",closeButtonText:"حذف فیلتر ها",onCloseButton:()=>y(),onSubmit:()=>j()})]})]})},D=t(12767),k=t(10504),K=t(21949),S=e=>{let{data:r}=e,t=(0,a.useRouter)();return(0,n.jsx)(D.iA,{columns:[{accessorKey:"index",header:"ردیف",cell:e=>(0,n.jsx)(h.xv,{...K.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:y.K.gray[11]},children:e.row.index+1})},{accessorKey:"sourceCityName",header:"مبدا",cell:e=>{let r=e.getValue();return(0,n.jsx)(h.xv,{...K.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:y.K.gray[11]},children:r||"-"})}},{accessorKey:"destinationCity",header:"مقصد",cell:e=>{let r=e.getValue();return(0,n.jsx)(h.xv,{...K.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:y.K.gray[11]},children:r||"-"})}},{accessorKey:"createAt",header:"تاریخ ساخت برنامه",cell:e=>{let r=e.getValue();return(0,n.jsx)(h.xv,{...K.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:y.K.gray[11]},children:r||"-"})}},{accessorKey:"departureDate",header:"تاریخ رفت",cell:e=>{let r=e.getValue();return(0,n.jsx)(h.xv,{...K.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:y.K.gray[11]},children:r?(0,k.l)(r):"-"})}},{accessorKey:"returnDate",header:"تاریخ بازگشت",cell:e=>{let r=e.getValue();return(0,n.jsx)(h.xv,{...K.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:y.K.gray[11]},children:r?(0,k.l)(r):"-"})}},{id:"details",cell:e=>{let{row:r}=e,l=r.original;return(0,n.jsx)(h.kC,{width:"100%",height:"100%",align:"center",justify:"center",children:(0,n.jsx)(h.zx,{variant:"surface",onClick:()=>{console.log("item",l),t.push("/plans/user-plan")},children:"..."})})}}],data:r})},E=t(29962),w=t(72051),N=t(51360),P=t(94881),V=t(86555),z=t(25231);function A(e){let{params:r,searchParams:t}=e,{data:c,isLoading:x,isFetching:g}=(0,o.useQuery)({queryKey:["user_info"],queryFn:async()=>(0,u.bG)(b)});console.log(r.slug);let{push:p}=(0,a.useRouter)(),[j,v]=(0,l.useState)(!1),b=Number(r.slug),D=(0,s.cI)({defaultValues:{page:Number(t.page)||1,limit:Number(t.limit)||10,sortDate:t.sortDate?t.sortDate:"",userId:b,targetDate:t.targetDate?t.targetDate:"",originCityId:t.originCityId?Number(t.originCityId):"",originProvinceId:t.originProvinceId?Number(t.originProvinceId):"",destinationCityId:t.destinationCityId?Number(t.destinationCityId):"",destinationProvinceId:t.destinationProvinceId?Number(t.destinationProvinceId):"",departureDateStart:t.departureDateStart?Number(t.departureDateStart):"",departureDateEnd:t.departureDateEnd?Number(t.departureDateEnd):"",returnDateStart:t.returnDateStart?Number(t.returnDateStart):"",returnDateEnd:t.returnDateEnd?Number(t.returnDateEnd):"",sort:""}}),{watch:k,setValue:A,handleSubmit:Q}=D;console.log("USER Data",c);let{data:_,mutate:T,isPending:Z}=(0,d.useMutation)({mutationFn:async e=>(0,u.gG)(e),onSuccess:async e=>{let r=Object.fromEntries(Object.entries(k()).filter(e=>{let[r,t]=e;return"userId"!==r&&void 0!==t&&""!==t&&"none"!==t&&null!==t&&!(Array.isArray(t)&&0===t.length)&&!(Array.isArray(t)&&t.every(e=>""===e))&&!(Array.isArray(t)&&t.every(e=>"none"===e))&&!("object"==typeof t&&null!==t&&0===Object.keys(t).length)})),t=(0,z.X)(r);p("/user/".concat(b,"?").concat(t)),console.log("OnSuccess",e)},onError:async e=>{console.log("OnError",e)}});(0,l.useEffect)(()=>{T(k())},[]);let R=()=>{T(k()),console.log("run")};return console.log("DATA",_),(0,n.jsxs)(h.kC,{direction:"column",children:[(0,n.jsx)(E.default,{title:"اطلاعات کاربر",isNavigation:!0}),(0,n.jsx)(h.xu,{p:"24px 110px 40px 40px ",children:(0,n.jsx)(h.rj,{width:"100%",maxWidth:"1920px",mx:"auto",children:(0,n.jsx)(s.RV,{...D,children:(0,n.jsxs)("form",{onSubmit:Q(R),children:[(0,n.jsxs)(h.rj,{width:"100%",gapY:"5",children:[x||g?(0,n.jsx)(i.$j,{style:{marginInline:"auto",scale:2,marginBlock:"20px"}}):(0,n.jsx)(P.Z,{...null==c?void 0:c.userInfo,type:"USER",onEditInfo:()=>v(!0)}),(0,n.jsx)(h.xv,{...K.p.title2,style:{color:y.K.gray[12]},children:"برنامه های کاربر"}),(0,n.jsx)(I,{onSubmit:()=>T(k()),userId:b}),Z?(0,n.jsx)(i.$j,{style:{marginInline:"auto",scale:2,marginBlock:"20px"}}):(0,n.jsx)(S,{data:(null==_?void 0:_.latestTrips)?_.latestTrips:[]}),(null==_?void 0:_.latestTrips)&&(0,n.jsxs)(h.kC,{width:"100%",align:"center",justify:"between",children:[(0,n.jsx)(w.Z,{current:k("page"),total:null==_?void 0:_.totalPages,onPageChange:e=>{A("page",e),(0,V.Z)(e),R()}}),(0,n.jsx)(N.Z,{data:null==_?void 0:_.latestTrips,currentPage:null==_?void 0:_.currentPage,totalCount:null==_?void 0:_.totalCount})]})]}),(0,n.jsxs)(h.u_,{isOpen:j,onClose:()=>v(!1),children:[(0,n.jsx)(f.Z,{title:"ویرایش کاربر",icon:(0,n.jsx)(C.x8,{}),handleClose:()=>v(!1)}),(0,n.jsx)(m,{onClose:()=>v(!1),userId:b,data:c})]})]})})})})]})}},94881:function(e,r,t){"use strict";var n=t(57437);t(2265);var l=t(66648),s=t(96396),a=t(40252),i=t(1845),o=t(21949),d=t(10504);r.Z=e=>{let{pic:r,name:t,last_name:c,birthday:x,gender:h,mobile:g,email:p,type:j,status:y,onShowProfile:m,onDeActive:v,onEditInfo:b}=e;return(0,n.jsx)(a.default,{hero:"سازنده برنامه",children:(0,n.jsxs)(s.rj,{width:"100%",columns:"3",px:"4",gapX:"5",style:{gridTemplateColumns:"auto 3fr auto"},children:[(0,n.jsx)(s.xu,{width:"130px",height:"130px",position:"relative",children:(0,n.jsx)(l.default,{src:r?"".concat("https://uploader.darkube.app/").concat(r):"",alt:"تصویر کاربر",fill:!0,style:{borderRadius:"100px",border:"1px solid ".concat(i.K.blue[9])}})}),(0,n.jsxs)(s.rj,{width:"3",columns:"3",gapY:"5",children:[(0,n.jsx)(u,{label:"نام",value:t}),(0,n.jsx)(u,{label:"نام خانوادگی",value:c}),(0,n.jsx)(u,{label:"تاریخ تولد",value:(0,d.l)(x)}),(0,n.jsx)(u,{label:"جنسیت",value:"MALE"===h?"مرد":"زن"}),(0,n.jsx)(u,{label:"شماره تماس",value:g}),(0,n.jsx)(u,{label:"ایمیل",value:p})]}),(0,n.jsx)(s.kC,{align:"end",children:"PLAN"===j?(0,n.jsx)(s.zx,{size:"3",colorVariant:"PINK",onClick:m,children:(0,n.jsx)(s.xv,{...o.p.body1,children:"مشاهده پروفایل"})}):(0,n.jsxs)(s.kC,{direction:"column",gap:"2",children:[!0===y?(0,n.jsx)(s.zx,{size:"3",colorVariant:"PINK",onClick:v,children:(0,n.jsx)(s.xv,{...o.p.body1,children:"غیرفعال کردن کاربر"})}):(0,n.jsx)(s.zx,{size:"3",onClick:b,children:(0,n.jsx)(s.xv,{...o.p.body1,children:"فعال سازی کاربر"})}),(0,n.jsx)(s.zx,{size:"3",onClick:b,children:(0,n.jsx)(s.xv,{...o.p.body1,children:"ویرایش اطلاعات"})})]})})]})})};let u=e=>{let{label:r,value:t}=e;return(0,n.jsxs)(s.kC,{align:"center",gap:"2",children:[(0,n.jsx)(s.xv,{...o.p.body2,style:{color:i.K.gray[10]},children:r}),(0,n.jsx)(s.xv,{...o.p.body1,style:{color:i.K.gray[12]},children:t||"-"})]})}},40252:function(e,r,t){"use strict";var n=t(57437),l=t(2265),s=t(89183),a=t(96396),i=t(1845);let o=l.forwardRef((e,r)=>{let{hero:t,children:l,...s}=e;return(0,n.jsxs)(d,{ref:r,...s,children:[(0,n.jsx)(a.kC,{className:"style",p:"8px 16px",children:(0,n.jsx)(a.X6,{as:"h6",size:"6",style:{color:i.K.gray[1],fontWeight:700},children:t})}),(0,n.jsx)(a.rj,{gap:"16px",p:"24px 16px 16px 16px",children:l})]})});r.default=o;let d=(0,s.ZP)(a.rj).withConfig({componentId:"sc-3db28b84-0"})(["background-color:",";border-radius:8px;border:1px solid ",";min-height:100px;.style{border-top-right-radius:8px;border-top-left-radius:8px;height:fit-content;background-color:",";}"],i.K.gray[2],i.K.gray[6],i.K.blue[10])}},function(e){e.O(0,[1553,3048,3497,8334,5452,8310,6990,9212,9673,3348,4518,9269,6648,5639,6396,3882,4011,7524,2971,7023,1744],function(){return e(e.s=30392)}),_N_E=e.O()}]);