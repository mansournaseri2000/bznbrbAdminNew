(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5524],{30392:function(e,t,r){Promise.resolve().then(r.bind(r,88141))},88141:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return T}});var n=r(57437),s=r(2265),a=r(39343),l=r(16463),i=r(94963),o=r(76351),d=r(93191),u=r(25524),c=r(27918),x=r(66648),p=r(51537),h=r(96396),g=r(52892),j=r(72549),y=r(31072),v=r(1845),m=e=>{let{onClose:t,userId:r,data:s}=e,{control:l,setValue:i,watch:o}=(0,a.cI)({defaultValues:{name:null==s?void 0:s.userInfo.name,last_name:null==s?void 0:s.userInfo.last_name,email:null==s?void 0:s.userInfo.email,birthday:null==s?void 0:s.userInfo.birthday,pic:null==s?void 0:s.userInfo.pic,gender:null==s?void 0:s.userInfo.gender,mobile:null==s?void 0:s.userInfo.mobile,status:null==s?void 0:s.userInfo.status}}),m=(0,d.useQueryClient)(),{mutate:b,isPending:f}=(0,u.useMutation)({mutationFn:async e=>(0,c.uz)(r,e),onSuccess:async e=>{!0===e.status?(t(),(0,y.ToastSuccess)("اطلاعات مورد نظر با موفقیت بروزرسانی شد"),m.invalidateQueries({queryKey:["user_info"]})):(0,y.ToastError)("لطفا دوباره امتحان نمایید")},onError:e=>{console.log(e),console.log("NOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO")}});return(0,n.jsxs)(h.rj,{width:"100%",gap:"5",style:{backgroundColor:v.K.gray[2]},children:[(0,n.jsx)(h.kC,{width:"100%",justify:"center",mt:"5",children:(0,n.jsx)(h.xu,{width:"120px",height:"120px",position:"relative",children:(0,n.jsx)(x.default,{src:o("pic")?"".concat("https://uploader.darkube.app/").concat(o("pic")):"",alt:"تصویر کاربر",fill:!0,style:{borderRadius:"100px",border:"1px solid ".concat(v.K.blue[9])}})})}),(0,n.jsxs)(h.rj,{columns:"2",gap:"5",px:"5",children:[(0,n.jsx)(a.Qr,{name:"name",control:l,render:e=>{let{field:t}=e;return(0,n.jsx)(h.nv,{...t,placeholder:"نام"})}}),(0,n.jsx)(a.Qr,{name:"last_name",control:l,render:e=>{let{field:t}=e;return(0,n.jsx)(h.nv,{...t,placeholder:"نام خانوادگی"})}}),(0,n.jsx)(a.Qr,{name:"gender",control:l,render:e=>{let{field:t}=e;return(0,n.jsx)(h.fp,{...t,placeholder:"جنسیت",size:"3",value:String(t.value),onValueChange:e=>{t.onChange(e)},children:p.Qd.map(e=>(0,n.jsx)(h.Ql,{value:e.value,children:e.name},e.id))})}}),(0,n.jsx)(a.Qr,{name:"birthday",control:l,render:e=>(0,n.jsx)(g.Z,{inputMode:"none",placeholder:"تاریخ تولد",value:e.field.value,onChangeValue:e=>{i("birthday",Number(new Date(e)))},style:{backgroundColor:v.K.gray[1]}})}),(0,n.jsx)(a.Qr,{name:"mobile",control:l,render:e=>{let{field:t}=e;return(0,n.jsx)(h.nv,{disabled:!0,...t,placeholder:"شماره تماس"})}}),(0,n.jsx)(a.Qr,{name:"email",control:l,render:e=>{let{field:t}=e;return(0,n.jsx)(h.nv,{...t,placeholder:"ایمیل"})}})]}),(0,n.jsx)(j.Z,{submitButtonText:"ثبت تغییرات",closeButtonText:"لغو و بازگشت",isLoading:f,onCloseButton:t,onSubmit:()=>b(o())})]})},b=r(33913),f=r(47964),C=r(77855),O=r(40722),I=e=>{let{onSubmit:t,isOpen:r,setIsOpen:s,userId:i,isPending:d}=e,u=(0,l.useRouter)(),{control:c,reset:x,setValue:g}=(0,a.Gc)(),y=(0,l.useSearchParams)(),v=e=>y.get(e)||"",{data:m}=(0,o.useQuery)({queryKey:["constant"],queryFn:async()=>(0,b.iV)()}),I=()=>{t()},D=()=>{x({page:1,limit:10,sortDate:"",targetDate:"",userId:i,originCityId:"",originProvinceId:"",destinationCityId:"",destinationProvinceId:"",departureDateStart:"",departureDateEnd:"",returnDateStart:"",returnDateEnd:"",sort:""}),u.replace("/user/".concat(i)),t(),s(!1)},k=e=>{switch(e){case 1:return g("sortDate","des"),g("targetDate","dep");case 2:return g("targetDate","dep"),g("sortDate","asc");case 3:return g("targetDate","ret"),g("sortDate","des");case 4:return g("targetDate","ret"),g("sortDate","asc")}};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(h.kC,{width:"100%",align:"center",justify:"between",children:[(0,n.jsx)(h.hU,{colorVariant:"BLUE",variant:"soft",type:"button",size:"4",onClick:()=>s(!0),children:(0,n.jsx)(O.wn,{})}),(0,n.jsx)(h.kC,{width:"240px",children:(0,n.jsx)(a.Qr,{name:"sort",control:c,render:e=>{let{field:r}=e;return(0,n.jsx)(h.fp,{size:"3",...r,placeholder:"مرتب سازی بر اساس",value:String(r.value||v("sort")),onValueChange:e=>{let n=p.gy.find(t=>t.id===Number(e));k(null==n?void 0:n.id),r.onChange(e),t()},children:p.gy.map(e=>(0,n.jsx)(h.Ql,{value:String(e.id),children:e.name},e.id))})}})})]}),(0,n.jsxs)(h.u_,{isOpen:r,onClose:()=>s(!1),children:[(0,n.jsx)(C.Z,{title:"فیلتر",icon:(0,n.jsx)(O.ol,{}),handleClose:()=>s(!1)}),(0,n.jsx)(f.Z,{province:(null==m?void 0:m.provinces)?m.provinces:[]}),(0,n.jsx)(j.Z,{submitButtonText:"اعمال فیلتر ها",closeButtonText:"حذف فیلتر ها",onCloseButton:()=>D(),onSubmit:()=>I(),isLoading:d})]})]})},D=r(12767),k=r(10504),S=r(21949),E=e=>{let{data:t}=e,r=(0,l.useRouter)();return(0,n.jsx)(D.iA,{columns:[{accessorKey:"index",header:"ردیف",cell:e=>(0,n.jsx)(h.xv,{...S.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:v.K.gray[11]},children:e.row.index+1})},{accessorKey:"sourceCityName",header:"مبدا",cell:e=>{let t=e.getValue();return(0,n.jsx)(h.xv,{...S.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:v.K.gray[11]},children:t||"-"})}},{accessorKey:"destinationCity",header:"مقصد",cell:e=>{let t=e.getValue();return(0,n.jsx)(h.xv,{...S.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:v.K.gray[11]},children:t||"-"})}},{accessorKey:"createdAt",header:"تاریخ ساخت برنامه",cell:e=>{let t=e.getValue();return(0,n.jsx)(h.xv,{...S.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:v.K.gray[11]},children:t?(0,k.l)(t):"-"})}},{accessorKey:"departureDate",header:"تاریخ رفت",cell:e=>{let t=e.getValue();return(0,n.jsx)(h.xv,{...S.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:v.K.gray[11]},children:t?(0,k.l)(t):"-"})}},{accessorKey:"returnDate",header:"تاریخ بازگشت",cell:e=>{let t=e.getValue();return(0,n.jsx)(h.xv,{...S.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:v.K.gray[11]},children:t?(0,k.l)(t):"-"})}},{id:"details",cell:e=>{let{row:t}=e,s=t.original;return(0,n.jsx)(h.kC,{width:"100%",height:"100%",align:"center",justify:"center",children:(0,n.jsx)(h.zx,{variant:"surface",onClick:e=>{e.preventDefault(),r.push("/plans/user-plan/".concat(s.tripId))},children:"..."})})}}],data:t})},K=r(29962),w=r(72051),z=r(51360),N=r(94881),P=r(86555),Q=r(25231);function T(e){let{params:t,searchParams:r}=e,{data:x,isLoading:p,isFetching:g}=(0,o.useQuery)({queryKey:["user_info"],queryFn:async()=>(0,c.bG)(T)}),{push:j}=(0,l.useRouter)(),[b,f]=(0,s.useState)(!1),[D,k]=(0,s.useState)(!1),T=Number(t.slug),V=(0,d.useQueryClient)(),_=(0,a.cI)({defaultValues:{page:Number(r.page)||1,limit:Number(r.limit)||10,sortDate:r.sortDate?r.sortDate:"",userId:T,targetDate:r.targetDate?r.targetDate:"",originCityId:r.originCityId?Number(r.originCityId):"",originProvinceId:r.originProvinceId?Number(r.originProvinceId):"",destinationCityId:r.destinationCityId?Number(r.destinationCityId):"",destinationProvinceId:r.destinationProvinceId?Number(r.destinationProvinceId):"",departureDateStart:r.departureDateStart?Number(r.departureDateStart):"",departureDateEnd:r.departureDateEnd?Number(r.departureDateEnd):"",returnDateStart:r.returnDateStart?Number(r.returnDateStart):"",returnDateEnd:r.returnDateEnd?Number(r.returnDateEnd):"",sort:r.sort||""}}),{watch:A,setValue:Z,handleSubmit:B}=_;console.log("USER Data",x);let{data:R,mutate:F,isPending:L}=(0,u.useMutation)({mutationFn:async e=>(0,c.gG)(e),onSuccess:async e=>{let t=Object.fromEntries(Object.entries(A()).filter(e=>{let[t,r]=e;return!("userId"===t||void 0===r||""===r||"none"===r||null===r||Array.isArray(r)&&0===r.length||Array.isArray(r)&&r.every(e=>""===e)||Array.isArray(r)&&r.every(e=>"none"===e))&&(!["departureDateStart","departureDateEnd","returnDateStart","returnDateEnd"].includes(t)||new Date(r).getTime())}));Object.keys(t).forEach(e=>{["departureDateStart","departureDateEnd","returnDateStart","returnDateEnd"].includes(e)&&(t[e]=new Date(t[e]).getTime())});let r=(0,Q.X)(t);j("/user/".concat(T,"?").concat(r)),k(!1),console.log("data",e)},onError:async e=>{console.log("OnError",e)}}),{mutate:q,isPending:M}=(0,u.useMutation)({mutationFn:async e=>(0,c.uz)(T,e),onSuccess:async e=>{!0===e.status?(V.invalidateQueries({queryKey:["user_info"]}),(0,y.ToastSuccess)("کاربر مورد نظر با موفقیت غیر فعال شد")):(0,y.ToastError)("لطفا دوباره امتحان نمایید")},onError:e=>{console.log(e)}});(0,s.useEffect)(()=>{F(A())},[]);let U=()=>{F(A()),console.log("run")},Y=e=>{let{name:t,last_name:r,email:n,birthday:s,gender:a}=e;return{name:t,last_name:r,email:n,birthday:s,gender:a,status:!1}},$=e=>{let{name:t,last_name:r,email:n,birthday:s,gender:a}=e;return{name:t,last_name:r,email:n,birthday:s,gender:a,status:!0}};return(0,n.jsxs)(h.kC,{direction:"column",children:[(0,n.jsx)(K.default,{title:"اطلاعات کاربر",isNavigation:!0}),(0,n.jsx)(h.xu,{p:"24px 110px 40px 40px ",children:(0,n.jsx)(h.rj,{width:"100%",maxWidth:"1920px",mx:"auto",children:(0,n.jsx)(a.RV,{..._,children:(0,n.jsxs)("form",{onSubmit:B(U),children:[(0,n.jsxs)(h.rj,{width:"100%",gapY:"5",children:[p||g?(0,n.jsx)(i.$j,{style:{marginInline:"auto",scale:2,marginBlock:"20px"}}):(0,n.jsx)(N.Z,{...null==x?void 0:x.userInfo,type:"USER",onDeActive:()=>{(null==x?void 0:x.userInfo)&&q(Y(x.userInfo))},onActive:()=>{(null==x?void 0:x.userInfo)&&q($(x.userInfo))},isLoading:M,onEditInfo:()=>f(!0)}),(0,n.jsx)(h.xv,{...S.p.title2,style:{color:v.K.gray[12]},children:"برنامه های کاربر"}),(0,n.jsx)(I,{onSubmit:()=>F(A()),userId:T,isOpen:D,setIsOpen:k,isPending:L}),L?(0,n.jsx)(i.$j,{style:{marginInline:"auto",scale:2,marginBlock:"20px"}}):(0,n.jsx)(E,{data:(null==R?void 0:R.latestTrips)?R.latestTrips:[]}),(null==R?void 0:R.latestTrips)&&(0,n.jsxs)(h.kC,{width:"100%",align:"center",justify:"between",children:[(0,n.jsx)(w.Z,{current:A("page"),total:null==R?void 0:R.totalPages,onPageChange:e=>{Z("page",e),(0,P.Z)(e),U()}}),(0,n.jsx)(z.Z,{data:null==R?void 0:R.latestTrips,currentPage:null==R?void 0:R.currentPage,totalCount:null==R?void 0:R.totalCount})]})]}),(0,n.jsxs)(h.u_,{isOpen:b,onClose:()=>f(!1),children:[(0,n.jsx)(C.Z,{title:"ویرایش کاربر",icon:(0,n.jsx)(O.x8,{}),handleClose:()=>f(!1)}),(0,n.jsx)(m,{onClose:()=>f(!1),userId:T,data:x})]})]})})})})]})}},94881:function(e,t,r){"use strict";var n=r(57437),s=r(2265),a=r(66648),l=r(94963),i=r(96396),o=r(40252),d=r(1845),u=r(21949),c=r(10504);t.Z=e=>{let{pic:t,name:r,last_name:p,birthday:h,gender:g,mobile:j,email:y,type:v,status:m,onShowProfile:b,onDeActive:f,onActive:C,onEditInfo:O,isLoading:I}=e,[D,k]=(0,s.useState)({isOpen:!1,key:"active"});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.default,{hero:"سازنده برنامه",children:(0,n.jsxs)(i.rj,{width:"100%",columns:"3",px:"4",gapX:"5",style:{gridTemplateColumns:"auto 3fr auto"},children:[(0,n.jsx)(i.xu,{width:"130px",height:"130px",position:"relative",children:(0,n.jsx)(a.default,{src:t?"".concat("https://uploader.darkube.app/").concat(t):"",alt:"تصویر کاربر",fill:!0,style:{borderRadius:"100px",border:"1px solid ".concat(d.K.blue[9])}})}),(0,n.jsxs)(i.rj,{width:"3",columns:"3",gapY:"5",children:[(0,n.jsx)(x,{label:"نام",value:r}),(0,n.jsx)(x,{label:"نام خانوادگی",value:p}),(0,n.jsx)(x,{label:"تاریخ تولد",value:(0,c.l)(h)}),(0,n.jsx)(x,{label:"جنسیت",value:"MALE"===g?"مرد":"زن"}),(0,n.jsx)(x,{label:"شماره تماس",value:j}),(0,n.jsx)(x,{label:"ایمیل",value:y})]}),(0,n.jsx)(i.kC,{align:"end",children:"PLAN"===v?(0,n.jsx)(i.zx,{size:"3",colorVariant:"PINK",onClick:b,children:(0,n.jsx)(i.xv,{...u.p.body1,children:"مشاهده پروفایل"})}):(0,n.jsxs)(i.kC,{direction:"column",gap:"2",children:[!0===m?(0,n.jsx)(i.zx,{size:"3",colorVariant:"PINK",type:"button",onClick:()=>k({isOpen:!0,key:"deActive"}),children:(0,n.jsx)(i.xv,{...u.p.body1,children:"غیرفعال کردن کاربر"})}):(0,n.jsx)(i.zx,{size:"3",type:"button",onClick:()=>k({isOpen:!0,key:"active"}),children:(0,n.jsx)(i.xv,{...u.p.body1,children:"فعال سازی کاربر"})}),(0,n.jsx)(i.zx,{size:"3",type:"button",onClick:O,children:(0,n.jsx)(i.xv,{...u.p.body1,children:"ویرایش اطلاعات"})})]})})]})}),(0,n.jsxs)(i.u_,{isOpen:D.isOpen,onClose:()=>k({...D,isOpen:!1}),children:["deActive"===D.key&&(0,n.jsxs)(i.rj,{gapY:"24px",p:"5",children:[(0,n.jsx)(i.xv,{children:"آیا از غیر فعال کردن این کاربر اظمینان دارید؟ "}),(0,n.jsxs)(i.rj,{gap:"10px",columns:"2",children:[(0,n.jsx)(i.zx,{onClick:()=>{f&&f(),k({...D,isOpen:!1})},variant:"soft",size:"4",children:(0,n.jsx)(i.xv,{...u.p.body3,children:I?(0,n.jsx)(l.$j,{}):"بله"})}),(0,n.jsx)(i.zx,{type:"button",onClick:()=>k({...D,isOpen:!1}),variant:"solid",size:"4",children:(0,n.jsx)(i.xv,{...u.p.body3,children:"خیر"})})]})]}),"active"===D.key&&(0,n.jsxs)(i.rj,{gapY:"24px",p:"5",children:[(0,n.jsx)(i.xv,{children:"آیا از فعال کردن این کاربر اظمینان دارید؟ "}),(0,n.jsxs)(i.rj,{gap:"10px",columns:"2",children:[(0,n.jsx)(i.zx,{onClick:()=>{C&&C(),k({...D,isOpen:!1})},variant:"soft",size:"4",children:(0,n.jsx)(i.xv,{...u.p.body3,children:I?(0,n.jsx)(l.$j,{}):"بله"})}),(0,n.jsx)(i.zx,{type:"button",onClick:()=>k({...D,isOpen:!1}),variant:"solid",size:"4",children:(0,n.jsx)(i.xv,{...u.p.body3,children:"خیر"})})]})]})]})]})};let x=e=>{let{label:t,value:r}=e;return(0,n.jsxs)(i.kC,{align:"center",gap:"2",children:[(0,n.jsx)(i.xv,{...u.p.body2,style:{color:d.K.gray[10]},children:t}),(0,n.jsx)(i.xv,{...u.p.body1,style:{color:d.K.gray[12]},children:r||"-"})]})}},40252:function(e,t,r){"use strict";var n=r(57437),s=r(2265),a=r(89183),l=r(96396),i=r(1845);let o=s.forwardRef((e,t)=>{let{hero:r,children:s,...a}=e;return(0,n.jsxs)(d,{ref:t,...a,children:[(0,n.jsx)(l.kC,{className:"style",p:"8px 16px",children:(0,n.jsx)(l.X6,{as:"h6",size:"6",style:{color:i.K.gray[1],fontWeight:700},children:r})}),(0,n.jsx)(l.rj,{gap:"16px",p:"24px 16px 16px 16px",children:s})]})});t.default=o;let d=(0,a.ZP)(l.rj).withConfig({componentId:"sc-3db28b84-0"})(["background-color:",";border-radius:8px;border:1px solid ",";min-height:100px;.style{border-top-right-radius:8px;border-top-left-radius:8px;height:fit-content;background-color:",";}"],i.K.gray[2],i.K.gray[6],i.K.blue[10])}},function(e){e.O(0,[1553,3048,3497,8334,5452,8310,6990,9212,9673,3348,4518,9269,6648,5639,6396,722,4011,7524,2971,7023,1744],function(){return e(e.s=30392)}),_N_E=e.O()}]);