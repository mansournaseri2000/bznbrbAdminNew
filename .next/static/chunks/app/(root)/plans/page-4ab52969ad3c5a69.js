(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[166],{15849:function(e,t,r){Promise.resolve().then(r.bind(r,23315))},23315:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return P}});var n=r(57437),a=r(2265),i=r(39343),s=r(16463),o=r(94963),l=r(25524),d=r(27918),u=r(76351),c=r(36721),h=r(51537),p=r(28326),g=r(23405),x=r(72549),y=r(77855),m=r(27533),j=r(21949),b=r(47964),f=e=>{let{onSubmit:t,isOpen:r,setIsOpen:a,isPending:o}=e,l=(0,s.useRouter)(),{control:d,reset:f,setValue:v}=(0,i.Gc)(),D=(0,s.useSearchParams)(),C=e=>D.get(e)||"",{data:I}=(0,u.useQuery)({queryKey:["constant"],queryFn:async()=>(0,c.iV)()}),w=()=>{t()},E=()=>{f({page:1,limit:10,searchQuery:"",sortDate:"",targetDate:"",userId:"",originCityId:"",originProvinceId:"",destinationCityId:"",destinationProvinceId:"",departureDateStart:"",departureDateEnd:"",returnDateStart:"",returnDateEnd:"",sort:""}),l.replace("/plans"),t(),a(!1)},S=e=>{switch(e){case 1:return v("sortDate","des"),v("targetDate","dep");case 2:return v("targetDate","dep"),v("sortDate","asc");case 3:return v("targetDate","ret"),v("sortDate","des");case 4:return v("targetDate","ret"),v("sortDate","asc")}};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(p.rj,{width:"100%",columns:"5",align:"center",gapX:"5",style:{gridTemplateColumns:"auto auto 2fr  1fr"},children:[(0,n.jsx)(p.hU,{type:"button",colorVariant:"BLUE",variant:"soft",size:"4",onClick:()=>a(!0),children:(0,n.jsx)(m.wn,{})}),(0,n.jsx)(p.zx,{colorVariant:"BLUE",variant:"ghost",type:"button",size:"4",onClick:()=>l.push("/plans/create-plan"),style:{padding:"11.5px 16px"},children:(0,n.jsxs)(p.kC,{gap:"2",align:"center",children:[(0,n.jsx)(p.xv,{...j.p.body1,children:"+"}),(0,n.jsx)(p.xv,{...j.p.body1,children:" افزودن برنامه"})]})}),(0,n.jsx)(i.Qr,{name:"searchQuery",control:d,render:e=>{let{field:r}=e;return(0,n.jsx)(g.Z,{...r,placeholder:"جستجو",defaultValue:C("searchQuery")?C("searchQuery"):"",onClick:t})}}),(0,n.jsx)(i.Qr,{name:"sort",control:d,render:e=>{let{field:r}=e;return(0,n.jsx)(p.fp,{...r,placeholder:"مرتب سازی بر اساس",size:"3",value:String(r.value||C("sort")),onValueChange:e=>{let n=h.gy.find(t=>t.id===Number(e));S(null==n?void 0:n.id),r.onChange(e),t()},children:h.gy.map(e=>(0,n.jsx)(p.Ql,{value:String(e.id),style:{padding:"13.5px 12px"},children:e.name},e.id))})}})]}),(0,n.jsxs)(p.u_,{isOpen:r,onClose:()=>a(!1),children:[(0,n.jsx)(y.Z,{title:"فیلتر",handleClose:()=>a(!1)}),(0,n.jsx)(b.Z,{province:(null==I?void 0:I.provinces)?I.provinces:[]}),(0,n.jsx)(x.Z,{submitButtonText:"اعمال فیلتر ها",closeButtonText:"حذف فیلتر ها",onCloseButton:()=>E(),onSubmit:()=>w(),isLoading:o})]})]})},v=r(12767),D=r(10504),C=r(1845),I=e=>{let t=(0,s.useRouter)();return(0,n.jsx)(v.iA,{columns:[{accessorKey:"index",header:"ردیف",cell:e=>(0,n.jsx)(p.xv,{...j.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:C.K.gray[11]},children:e.row.index+1})},{accessorKey:"userMobile",header:"شماره کاربر",cell:e=>{let t=e.getValue();return(0,n.jsx)(p.xv,{...j.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:C.K.gray[11]},children:t||"-"})}},{accessorKey:"sourceCityName",header:"مبدا",cell:e=>{let t=e.getValue();return(0,n.jsx)(p.xv,{...j.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:C.K.gray[11]},children:t||"-"})}},{accessorKey:"destinationCity",header:"مقصد",cell:e=>{let t=e.getValue();return(0,n.jsx)(p.xv,{...j.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:C.K.gray[11]},children:t||"-"})}},{accessorKey:"departureDate",header:"تاریخ رفت",cell:e=>{let t=e.getValue();return(0,n.jsx)(p.xv,{...j.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:C.K.gray[11]},children:t?(0,D.l)(t):"-"})}},{accessorKey:"returnDate",header:"تاریخ بازگشت",cell:e=>{let t=e.getValue();return(0,n.jsx)(p.xv,{...j.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:C.K.gray[11]},children:t?(0,D.l)(t):"-"})}},{id:"details",cell:e=>{let{row:r}=e,a=r.original;return(0,n.jsx)(p.kC,{width:"100%",height:"100%",align:"center",justify:"center",children:(0,n.jsx)(p.zx,{variant:"surface",onClick:e=>{e.preventDefault(),t.push("/plans/user-plan/".concat(a.tripId))},children:"..."})})}}],data:e.data})},w=r(29962),E=r(72051),S=r(51360),k=r(86555),N=r(25231);function P(e){let{searchParams:t}=e,{replace:r}=(0,s.useRouter)(),[u,c]=(0,a.useState)(t.page?Number(t.page):1),[h,g]=(0,a.useState)(!1),x=(0,i.cI)({defaultValues:{page:u,limit:Number(t.limit)||10,searchQuery:t.searchQuery||"",sortDate:t.sortDate?t.sortDate:"",targetDate:t.targetDate?t.targetDate:"",userId:t.userId?Number(t.userId):"",originCityId:t.originCityId?Number(t.originCityId):"",originProvinceId:t.originProvinceId?Number(t.originProvinceId):"",destinationCityId:t.destinationCityId?Number(t.destinationCityId):"",destinationProvinceId:t.destinationProvinceId?Number(t.destinationProvinceId):"",departureDateStart:t.departureDateStart?Number(t.departureDateStart):"",departureDateEnd:t.departureDateEnd?Number(t.departureDateEnd):"",returnDateStart:t.returnDateStart?Number(t.returnDateStart):"",returnDateEnd:t.returnDateEnd?Number(t.returnDateEnd):"",sort:t.sort||""}}),{watch:y,handleSubmit:m,setValue:b}=x,{data:v,mutate:D,isError:C,isPending:P}=(0,l.useMutation)({mutationKey:["trips-data"],mutationFn:async e=>(0,d.gG)(e),onSuccess:async e=>{let t=Object.fromEntries(Object.entries(y()).filter(e=>{let[t,r]=e;return!(void 0===r||""===r||"none"===r||null===r||Array.isArray(r)&&0===r.length||Array.isArray(r)&&r.every(e=>""===e)||Array.isArray(r)&&r.every(e=>"none"===e))&&(!["departureDateStart","departureDateEnd","returnDateStart","returnDateEnd"].includes(t)||new Date(r).getTime())}));Object.keys(t).forEach(e=>{["departureDateStart","departureDateEnd","returnDateStart","returnDateEnd"].includes(e)&&(t[e]=new Date(t[e]).getTime())});let n=(0,N.X)(t);r("/plans?".concat(n)),g(!1),console.log("data",e)},onError:async e=>{console.log("DATA Error",e)}});(0,a.useEffect)(()=>{D(y())},[]);let K=()=>{D(y())};return(0,n.jsxs)(p.kC,{direction:"column",children:[(0,n.jsx)(w.default,{title:"لیست برنامه ها",isNavigation:!0}),(0,n.jsx)(p.xu,{pr:"90px",children:(0,n.jsx)(p.rj,{width:"100%",maxWidth:"1920px",mx:"auto",children:(0,n.jsx)(i.RV,{...x,children:(0,n.jsx)("form",{onSubmit:m(K),children:(0,n.jsxs)(p.rj,{width:"100%",gap:"4",p:"5",children:[(0,n.jsx)(f,{onSubmit:()=>D(y()),isOpen:h,setIsOpen:g,isPending:P}),C?(0,n.jsx)(p.xv,{children:"مشکلی پیش آمده لطفا مجدد تلاش نمایید"}):P?(0,n.jsx)(o.$j,{style:{marginInline:"auto",scale:2,marginBlock:"40px"}}):v?(0,n.jsx)(I,{data:null==v?void 0:v.latestTrips}):(0,n.jsx)(p.kC,{width:"100%",justify:"center",mt:"6",children:(0,n.jsx)(p.xv,{...j.p.title1,children:"دیتایی موجود نیست"})}),(null==v?void 0:v.latestTrips)&&(0,n.jsxs)(p.kC,{width:"100%",align:"center",justify:"between",children:[(0,n.jsx)(E.Z,{current:u,total:v.totalPages,onPageChange:e=>{c(e),b("page",e),(0,k.Z)(e),K()}}),(0,n.jsx)(S.Z,{data:null==v?void 0:v.latestTrips,currentPage:null==v?void 0:v.currentPage,totalCount:null==v?void 0:v.totalCount})]})]})})})})})]})}},23405:function(e,t,r){"use strict";var n=r(57437),a=r(2265),i=r(39343),s=r(89183),o=r(28326),l=r(27533),d=r(1845);let u=(0,a.forwardRef)((e,t)=>{let{placeholder:r,defaultValue:a,onClick:s,...d}=e,{setValue:u}=(0,i.Gc)();return(0,n.jsxs)(c,{...d,ref:t,height:"fit-content",children:[(0,n.jsx)(h,{...d,ref:t,placeholder:r,variant:"surface",defaultValue:a,onChange:()=>{u("page",1)}}),(0,n.jsx)(o.hU,{size:"4",variant:"soft",onClick:s,children:(0,n.jsx)(l.HN,{})})]})});u.displayName="CustomSearch",t.Z=u;let c=(0,s.ZP)(o.kC).withConfig({componentId:"sc-2a59b276-0"})(["max-height:48px;align-items:center;border:1px solid ",";border-radius:12px;padding-inline-start:1rem;&:focus-within{background-color:",";box-shadow:",";border:1px solid ",";}"],d.K.gray[7],d.K.blue[2],d.i.shadow1,d.K.gray[3]),h=(0,s.ZP)(o.nv).withConfig({componentId:"sc-2a59b276-1"})(["&.rt-TextFieldRoot:where(.rt-variant-surface){border:none;outline:none;box-shadow:none;margin-block-end:-10px;}&:focus-within{outline:none !important;border:none !important;background-color:transparent !important;box-shadow:none !important;}@media (hover:hover){background-color:transparent !important;}"])}},function(e){e.O(0,[1553,3048,3497,8334,5452,8310,6990,9212,1825,8702,9269,5639,8326,7533,3898,9292,2971,7023,1744],function(){return e(e.s=15849)}),_N_E=e.O()}]);