(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[166],{31250:function(e,t,r){Promise.resolve().then(r.bind(r,23315))},23315:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return K}});var n=r(57437),a=r(2265),i=r(39343),s=r(16463),o=r(94963),l=r(25524),d=r(27918),c=r(76351),u=r(33913),h=r(51537),g=r(96396),p=r(23405),x=r(72549),y=r(77855),m=r(83882),j=r(21949),b=r(47964),f=e=>{let[t,r]=(0,a.useState)(!1),o=(0,s.useRouter)(),{control:l,reset:d,setValue:f}=(0,i.Gc)(),v=(0,s.useSearchParams)(),C=e=>v.get(e)||"",{data:D}=(0,c.useQuery)({queryKey:["constant"],queryFn:async()=>(0,u.iV)()}),I=()=>{r(!1)},w=()=>{d({page:1,limit:10,searchQuery:"",sortDate:"",targetDate:"",userId:"",originCityId:"",originProvinceId:"",destinationCityId:"",destinationProvinceId:"",departureDateStart:"",departureDateEnd:"",returnDateStart:"",returnDateEnd:"",sort:""}),o.replace("/plans"),e.onSubmit(),r(!1)},k=e=>{switch(e){case 1:return f("sortDate","des"),f("targetDate","dep");case 2:return f("targetDate","dep"),f("sortDate","asc");case 3:return f("targetDate","ret"),f("sortDate","des");case 4:return f("targetDate","ret"),f("sortDate","asc")}};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(g.rj,{width:"100%",columns:"5",align:"center",gapX:"5",style:{gridTemplateColumns:"auto auto 2fr  1fr"},children:[(0,n.jsx)(g.hU,{type:"button",colorVariant:"BLUE",variant:"soft",size:"4",onClick:()=>r(!0),children:(0,n.jsx)(m.wn,{})}),(0,n.jsx)(g.zx,{colorVariant:"BLUE",variant:"ghost",size:"4",onClick:()=>o.push("/plans/create-plan"),children:(0,n.jsxs)(g.kC,{gap:"2",align:"center",children:[(0,n.jsx)(g.xv,{...j.p.body1,children:"+"}),(0,n.jsx)(g.xv,{...j.p.body1,children:" افزودن نقطه"})]})}),(0,n.jsx)(i.Qr,{name:"searchQuery",control:l,render:t=>{let{field:r}=t;return(0,n.jsx)(p.Z,{...r,placeholder:"جستجو",defaultValue:C("searchQuery")?C("searchQuery"):"",onClick:e.onSubmit})}}),(0,n.jsx)(i.Qr,{name:"sort",control:l,render:t=>{let{field:r}=t;return(0,n.jsx)(g.fp,{...r,placeholder:"مرتب سازی بر اساس",size:"3",value:String(r.value),onValueChange:t=>{let n=h.gy.find(e=>e.id===Number(t));k(null==n?void 0:n.id),r.onChange(t),e.onSubmit()},children:h.gy.map(e=>(0,n.jsx)(g.Ql,{value:String(e.id),style:{padding:"13.5px 12px"},children:e.name},e.id))})}})]}),(0,n.jsxs)(g.u_,{isOpen:t,onClose:()=>r(!1),children:[(0,n.jsx)(y.Z,{title:"فیلتر",icon:(0,n.jsx)(m.ol,{}),handleClose:()=>r(!1)}),(0,n.jsx)(b.Z,{province:(null==D?void 0:D.provinces)?D.provinces:[]}),(0,n.jsx)(x.Z,{submitButtonText:"اعمال فیلتر ها",closeButtonText:"حذف فیلتر ها",onCloseButton:()=>w(),onSubmit:()=>I()})]})]})},v=r(12767),C=r(10504),D=r(1845),I=e=>{let t=(0,s.useRouter)();return(0,n.jsx)(v.iA,{columns:[{accessorKey:"index",header:"ردیف",cell:e=>(0,n.jsx)(g.xv,{...j.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:D.K.gray[11]},children:e.row.index+1})},{accessorKey:"userMobile",header:"شماره کاربر",cell:e=>{let t=e.getValue();return(0,n.jsx)(g.xv,{...j.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:D.K.gray[11]},children:t||"-"})}},{accessorKey:"sourceCityName",header:"مبدا",cell:e=>{let t=e.getValue();return(0,n.jsx)(g.xv,{...j.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:D.K.gray[11]},children:t||"-"})}},{accessorKey:"destinationCity",header:"مقصد",cell:e=>{let t=e.getValue();return(0,n.jsx)(g.xv,{...j.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:D.K.gray[11]},children:t||"-"})}},{accessorKey:"departureDate",header:"تاریخ رفت",cell:e=>{let t=e.getValue();return(0,n.jsx)(g.xv,{...j.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:D.K.gray[11]},children:t?(0,C.l)(t):"-"})}},{accessorKey:"returnDate",header:"تاریخ بازگشت",cell:e=>{let t=e.getValue();return(0,n.jsx)(g.xv,{...j.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:D.K.gray[11]},children:t?(0,C.l)(t):"-"})}},{id:"details",cell:e=>{let{row:r}=e,a=r.original;return(0,n.jsx)(g.kC,{width:"100%",height:"100%",align:"center",justify:"center",children:(0,n.jsx)(g.zx,{variant:"surface",onClick:()=>{console.log("item",a),t.push("/plans/user-plan/".concat(a.userId,"/").concat(a.tripId))},children:"..."})})}}],data:e.data})},w=r(29962),k=r(72051),S=r(51360),N=r(86555),E=r(25231);function K(e){let{searchParams:t}=e,{replace:r}=(0,s.useRouter)(),[c,u]=(0,a.useState)(t.page?Number(t.page):1),h=(0,i.cI)({defaultValues:{page:c,limit:Number(t.limit)||10,searchQuery:t.searchQuery||"",sortDate:t.sortDate?t.sortDate:"",targetDate:t.targetDate?t.targetDate:"",userId:t.userId?Number(t.userId):"",originCityId:t.originCityId?Number(t.originCityId):"",originProvinceId:t.originProvinceId?Number(t.originProvinceId):"",destinationCityId:t.destinationCityId?Number(t.destinationCityId):"",destinationProvinceId:t.destinationProvinceId?Number(t.destinationProvinceId):"",departureDateStart:t.departureDateStart?Number(t.departureDateStart):"",departureDateEnd:t.departureDateEnd?Number(t.departureDateEnd):"",returnDateStart:t.returnDateStart?Number(t.returnDateStart):"",returnDateEnd:t.returnDateEnd?Number(t.returnDateEnd):"",sort:""}}),{watch:p,handleSubmit:x,setValue:y}=h,{data:m,mutate:b,isError:v,isPending:C}=(0,l.useMutation)({mutationKey:["trips-data"],mutationFn:async e=>(0,d.gG)(e),onSuccess:async e=>{let t=Object.fromEntries(Object.entries(p()).filter(e=>{let[t,r]=e;return void 0!==r&&""!==r&&"none"!==r&&null!==r&&!(Array.isArray(r)&&0===r.length)&&!(Array.isArray(r)&&r.every(e=>""===e))&&!(Array.isArray(r)&&r.every(e=>"none"===e))&&!("object"==typeof r&&null!==r&&0===Object.keys(r).length)})),n=(0,E.X)(t);r("/plans?".concat(n)),console.log("data",e)},onError:async e=>{console.log("DATA Error",e)}});(0,a.useEffect)(()=>{b(p())},[]);let D=()=>{b(p())};return(0,n.jsxs)(g.kC,{direction:"column",children:[(0,n.jsx)(w.default,{title:"لیست برنامه ها",isNavigation:!0}),(0,n.jsx)(g.xu,{pr:"90px",children:(0,n.jsx)(g.rj,{width:"100%",maxWidth:"1920px",mx:"auto",children:(0,n.jsx)(i.RV,{...h,children:(0,n.jsx)("form",{onSubmit:x(D),children:(0,n.jsxs)(g.rj,{width:"100%",gap:"4",p:"5",children:[(0,n.jsx)(f,{onSubmit:()=>b(p())}),v?(0,n.jsx)(g.xv,{children:"مشکلی پیش آمده لطفا مجدد تلاش نمایید"}):C?(0,n.jsx)(o.$j,{style:{marginInline:"auto",scale:2,marginBlock:"40px"}}):m?(0,n.jsx)(I,{data:null==m?void 0:m.latestTrips}):(0,n.jsx)(g.kC,{width:"100%",justify:"center",mt:"6",children:(0,n.jsx)(g.xv,{...j.p.title1,children:"دیتایی موجود نیست"})}),(null==m?void 0:m.latestTrips)&&(0,n.jsxs)(g.kC,{width:"100%",align:"center",justify:"between",children:[(0,n.jsx)(k.Z,{current:c,total:m.totalPages,onPageChange:e=>{u(e),y("page",e),(0,N.Z)(e),D()}}),(0,n.jsx)(S.Z,{data:null==m?void 0:m.latestTrips,currentPage:null==m?void 0:m.currentPage,totalCount:null==m?void 0:m.totalCount})]})]})})})})})]})}},23405:function(e,t,r){"use strict";var n=r(57437),a=r(2265),i=r(89183),s=r(96396),o=r(83882),l=r(1845);let d=(0,a.forwardRef)((e,t)=>{let{placeholder:r,defaultValue:a,onClick:i,...l}=e;return(0,n.jsxs)(c,{...l,ref:t,height:"fit-content",children:[(0,n.jsx)(u,{placeholder:r,variant:"surface",defaultValue:a}),(0,n.jsx)(s.hU,{size:"4",variant:"soft",onClick:i,children:(0,n.jsx)(o.HN,{})})]})});d.displayName="CustomSearch",t.Z=d;let c=(0,i.ZP)(s.kC).withConfig({componentId:"sc-b2f9bf24-0"})(["align-items:center;border:1px solid ",";border-radius:12px;padding-inline-start:1rem;&:focus-within{background-color:",";box-shadow:",";border:1px solid ",";}"],l.K.gray[7],l.K.blue[2],l.i.shadow1,l.K.gray[3]),u=(0,i.ZP)(s.nv).withConfig({componentId:"sc-b2f9bf24-1"})(["&.rt-TextFieldRoot:where(.rt-variant-surface){border:none;outline:none;box-shadow:none;margin-block-end:-10px;}&:focus-within{outline:none !important;border:none !important;background-color:transparent !important;box-shadow:none !important;}@media (hover:hover){background-color:transparent !important;}"])}},function(e){e.O(0,[1553,3048,3497,8334,5452,8310,6990,9212,9673,3348,4518,9269,5639,6396,3882,4011,7524,2971,7023,1744],function(){return e(e.s=31250)}),_N_E=e.O()}]);