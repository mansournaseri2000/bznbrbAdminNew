(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[166],{31250:function(e,t,r){Promise.resolve().then(r.bind(r,23315))},23315:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return P}});var n=r(57437),a=r(2265),s=r(39343),l=r(94963),o=r(25524),i=r(27918),c=r(16463),d=r(76351),u=r(19156),h=r(51537),x=r(96396),g=r(23405),p=r(72549),y=r(77855),j=r(60376),m=r(83882),f=r(21949),v=r(47964),b=e=>{let[t,r]=(0,a.useState)(!1),l=(0,c.useSearchParams)(),o=(0,c.useRouter)(),{control:i,watch:b,reset:C,setValue:w}=(0,s.Gc)();console.log("Watch",b());let{data:k}=(0,d.useQuery)({queryKey:["constant"],queryFn:async()=>(0,u.iV)()}),D=()=>{r(!1)},I=()=>{C(),(0,j.L)(o,l,{}),r(!1)},K=e=>{switch(e){case 1:return w("sortDate","des"),w("targetDate","dep");case 2:return w("targetDate","dep"),w("sortDate","asc");case 3:return w("targetDate","ret"),w("sortDate","des");case 4:return w("targetDate","ret"),w("sortDate","asc")}};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(x.rj,{width:"100%",columns:"5",align:"center",gapX:"5",style:{gridTemplateColumns:"auto auto 2fr  1fr"},children:[(0,n.jsx)(x.hU,{type:"button",colorVariant:"BLUE",variant:"soft",size:"4",onClick:()=>r(!0),children:(0,n.jsx)(m.wn,{})}),(0,n.jsx)(x.zx,{colorVariant:"BLUE",variant:"ghost",size:"4",onClick:()=>o.push("/plans/create-plan"),children:(0,n.jsxs)(x.kC,{gap:"2",align:"center",children:[(0,n.jsx)(x.xv,{...f.p.body1,children:"+"}),(0,n.jsx)(x.xv,{...f.p.body1,children:" افزودن نقطه"})]})}),(0,n.jsx)(s.Qr,{name:"searchQuery",control:i,render:t=>{let{field:r}=t;return(0,n.jsx)(g.Z,{...r,placeholder:"جستجو",onClick:e.onSubmit})}}),(0,n.jsx)(s.Qr,{name:"sort",control:i,render:t=>{let{field:r}=t;return(0,n.jsx)(x.fp,{...r,placeholder:"مرتب سازی بر اساس",size:"3",value:String(r.value),onValueChange:t=>{let n=h.gy.find(e=>e.id===Number(t));K(null==n?void 0:n.id),r.onChange(t),e.onSubmit()},children:h.gy.map(e=>(0,n.jsx)(x.Ql,{value:String(e.id),style:{padding:"13.5px 12px"},children:e.name},e.id))})}})]}),(0,n.jsxs)(x.u_,{isOpen:t,onClose:()=>r(!1),children:[(0,n.jsx)(y.Z,{title:"فیلتر",icon:(0,n.jsx)(m.ol,{}),handleClose:()=>r(!1)}),(0,n.jsx)(v.Z,{province:(null==k?void 0:k.provinces)?k.provinces:[]}),(0,n.jsx)(p.Z,{submitButtonText:"اعمال فیلتر ها",closeButtonText:"حذف فیلتر ها",onCloseButton:()=>I(),onSubmit:()=>D()})]})]})},C=r(12767),w=r(10504),k=r(1845),D=e=>{let t=(0,c.useRouter)();return(0,n.jsx)(C.iA,{columns:[{accessorKey:"index",header:"ردیف",cell:e=>(0,n.jsx)(x.xv,{...f.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:k.K.gray[11]},children:e.row.index+1})},{accessorKey:"fullName",header:"نام کاربر سازنده",cell:e=>{let t=e.getValue();return(0,n.jsx)(x.xv,{...f.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:k.K.gray[11]},children:t||"-"})}},{accessorKey:"sourceCityName",header:"مبدا",cell:e=>{let t=e.getValue();return(0,n.jsx)(x.xv,{...f.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:k.K.gray[11]},children:t||"-"})}},{accessorKey:"destinationCity",header:"مقصد",cell:e=>{let t=e.getValue();return(0,n.jsx)(x.xv,{...f.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:k.K.gray[11]},children:t||"-"})}},{accessorKey:"departureDate",header:"تاریخ رفت",cell:e=>{let t=e.getValue();return(0,n.jsx)(x.xv,{...f.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:k.K.gray[11]},children:t?(0,w.l)(t):"-"})}},{accessorKey:"returnDate",header:"تاریخ بازگشت",cell:e=>{let t=e.getValue();return(0,n.jsx)(x.xv,{...f.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:k.K.gray[11]},children:t?(0,w.l)(t):"-"})}},{id:"details",cell:e=>{let{row:r}=e,a=r.original;return(0,n.jsx)(x.kC,{width:"100%",height:"100%",align:"center",justify:"center",children:(0,n.jsx)(x.zx,{variant:"surface",onClick:()=>{console.log("item",a),t.push("/plans/user-plan/".concat(a.userId,"/").concat(a.tripId))},children:"..."})})}}],data:e.data})},I=r(29962),K=r(72051),S=r(51360),E=r(86555);function P(e){let{searchParams:t}=e,[r,c]=(0,a.useState)(t.page?Number(t.page):1),d=(0,s.cI)({defaultValues:{page:r,limit:10,searchQuery:"",sortDate:"",targetDate:"",userId:"",originCityId:"",originProvinceId:"",destinationCityId:"",destinationProvinceId:"",departureDateStart:"",departureDateEnd:"",returnDateStart:"",returnDateEnd:"",sort:""}}),{watch:u,handleSubmit:h,setValue:g}=d,{data:p,mutate:y,isError:j,isPending:m}=(0,o.useMutation)({mutationKey:["trips-data"],mutationFn:async e=>(0,i.gG)(e),onSuccess:async e=>{console.log("data",e)},onError:async e=>{console.log("DATA Error",e)}});(0,a.useEffect)(()=>{y(u())},[]),console.log("TripsData",p);let v=()=>{y(u())};return(0,n.jsxs)(x.kC,{direction:"column",children:[(0,n.jsx)(I.default,{title:"لیست برنامه ها",isNavigation:!0}),(0,n.jsx)(x.xu,{pr:"90px",children:(0,n.jsx)(s.RV,{...d,children:(0,n.jsx)("form",{onSubmit:h(v),children:(0,n.jsxs)(x.rj,{width:"100%",gap:"4",p:"5",children:[(0,n.jsx)(b,{onSubmit:()=>y(u())}),j?(0,n.jsx)(x.xv,{children:"مشکلی پیش آمده لطفا مجدد تلاش نمایید"}):m?(0,n.jsx)(l.$j,{style:{marginInline:"auto",scale:2,marginBlock:"40px"}}):p?(0,n.jsx)(D,{data:null==p?void 0:p.latestTrips}):(0,n.jsx)(x.kC,{width:"100%",justify:"center",mt:"6",children:(0,n.jsx)(x.xv,{...f.p.title1,children:"دیتایی موجود نیست"})}),(null==p?void 0:p.latestTrips)&&(0,n.jsxs)(x.kC,{width:"100%",align:"center",justify:"between",children:[(0,n.jsx)(K.Z,{current:r,total:p.totalPages,onPageChange:e=>{c(e),g("page",e),(0,E.Z)(e),v()}}),(0,n.jsx)(S.Z,{data:null==p?void 0:p.latestTrips,currentPage:null==p?void 0:p.currentPage,totalCount:null==p?void 0:p.totalCount})]})]})})})})]})}},23405:function(e,t,r){"use strict";var n=r(57437),a=r(2265),s=r(89183),l=r(96396),o=r(83882),i=r(1845);let c=(0,a.forwardRef)((e,t)=>{let{placeholder:r,onClick:a,...s}=e;return(0,n.jsxs)(d,{...s,ref:t,children:[(0,n.jsx)(u,{placeholder:r,variant:"surface"}),(0,n.jsx)(l.hU,{size:"4",variant:"soft",onClick:a,children:(0,n.jsx)(o.HN,{})})]})});c.displayName="CustomSearch",t.Z=c;let d=(0,s.ZP)(l.kC).withConfig({componentId:"sc-4123217d-0"})(["border:1px solid ",";border-radius:12px;padding-inline-start:1rem;&:focus-within{background-color:",";box-shadow:",";border:1px solid ",";}"],i.K.gray[7],i.K.blue[2],i.i.shadow1,i.K.gray[3]),u=(0,s.ZP)(l.nv).withConfig({componentId:"sc-4123217d-1"})(["&.rt-TextFieldRoot:where(.rt-variant-surface){border:none;outline:none;box-shadow:none;margin-block-end:-10px;}&:focus-within{outline:none !important;border:none !important;background-color:transparent !important;box-shadow:none !important;}@media (hover:hover){background-color:transparent !important;}"])}},function(e){e.O(0,[1553,3048,3497,8334,5452,8310,6990,9212,9673,3348,4518,9269,5639,6396,3882,6412,7801,2971,7023,1744],function(){return e(e.s=31250)}),_N_E=e.O()}]);