(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[166],{15849:function(e,t,r){Promise.resolve().then(r.bind(r,23315))},23315:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return E}});var n=r(57437),a=r(2265),i=r(39343),s=r(94963),o=r(93191),l=r(43767),c=r(37969),d=r(20254),u=r(16463),h=r(36721),p=r(51537),g=r(7507),x=r(23405),y=r(72549),m=r(77855),f=r(27533),j=r(21949),v=r(47964),b=e=>{let{onSubmit:t,isOpen:r,setIsOpen:a,isPending:s}=e,o=(0,u.useRouter)(),{control:c,reset:d,setValue:b}=(0,i.Gc)(),w=(0,u.useSearchParams)(),D=e=>w.get(e)||"",{data:C}=(0,l.a)({queryKey:["constant"],queryFn:async()=>(0,h.iV)()}),I=()=>{t()},N=()=>{d({page:1,searchQuery:"",sortDate:"",targetDate:"",userId:"",originCityId:"",originProvinceId:"",destinationCityId:"",destinationProvinceId:"",departureDateStart:"",departureDateEnd:"",returnDateStart:"",returnDateEnd:"",sort:""}),o.replace("/plans"),t(),a(!1)},S=e=>{switch(e){case 1:return b("sortDate","des"),b("targetDate","dep");case 2:return b("targetDate","dep"),b("sortDate","asc");case 3:return b("targetDate","ret"),b("sortDate","des");case 4:return b("targetDate","ret"),b("sortDate","asc")}};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(g.rj,{width:"100%",columns:"5",align:"center",gapX:"5",style:{gridTemplateColumns:"auto auto 2fr  1fr"},children:[(0,n.jsx)(g.hU,{type:"button",colorVariant:"BLUE",variant:"soft",size:"4",onClick:()=>a(!0),children:(0,n.jsx)(f.wn,{})}),(0,n.jsx)(g.zx,{colorVariant:"BLUE",variant:"ghost",type:"button",size:"4",onClick:()=>o.push("/plans/create-plan"),style:{padding:"11.5px 16px"},children:(0,n.jsxs)(g.kC,{gap:"2",align:"center",children:[(0,n.jsx)(g.xv,{...j.p.body1,children:"+"}),(0,n.jsx)(g.xv,{...j.p.body1,children:" افزودن برنامه"})]})}),(0,n.jsx)(i.Qr,{name:"searchQuery",control:c,render:e=>{let{field:t}=e;return(0,n.jsx)(x.Z,{...t,placeholder:"جستجو",defaultValue:D("searchQuery")?D("searchQuery"):""})}}),(0,n.jsx)(i.Qr,{name:"sort",control:c,render:e=>{let{field:r}=e;return(0,n.jsx)(g.fp,{...r,placeholder:"مرتب سازی بر اساس",size:"3",value:String(r.value||D("sort")),onValueChange:e=>{let n=p.gy.find(t=>t.id===Number(e));S(null==n?void 0:n.id),r.onChange(e),t(),b("page",1)},children:p.gy.map(e=>(0,n.jsx)(g.Ql,{value:String(e.id),style:{padding:"13.5px 12px"},children:e.name},e.id))})}})]}),(0,n.jsxs)(g.u_,{isOpen:r,onClose:()=>a(!1),children:[(0,n.jsx)(m.Z,{title:"فیلتر",handleClose:()=>a(!1)}),(0,n.jsx)(v.Z,{province:(null==C?void 0:C.provinces)?C.provinces:[]}),(0,n.jsx)(y.Z,{submitButtonText:"اعمال فیلتر ها",closeButtonText:"حذف فیلتر ها",onCloseButton:()=>N(),onSubmit:()=>{I(),a(!1)},isLoading:s})]})]})},w=r(46302),D=r(10504),C=r(1845),I=e=>{let t=(0,u.useRouter)();return(0,n.jsx)(w.iA,{columns:[{accessorKey:"index",header:"ردیف",cell:e=>(0,n.jsx)(g.xv,{...j.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:C.K.gray[11]},children:e.row.index+1})},{accessorKey:"userMobile",header:"شماره کاربر",cell:e=>{let t=e.getValue();return(0,n.jsx)(g.xv,{...j.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:C.K.gray[11]},children:t||"-"})}},{accessorKey:"sourceCityName",header:"مبدا",cell:e=>{let t=e.getValue();return(0,n.jsx)(g.xv,{...j.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:C.K.gray[11]},children:t||"-"})}},{accessorKey:"destinationCity",header:"مقصد",cell:e=>{let t=e.getValue();return(0,n.jsx)(g.xv,{...j.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:C.K.gray[11]},children:t||"-"})}},{accessorKey:"departureDate",header:"تاریخ رفت",cell:e=>{let t=e.getValue();return(0,n.jsx)(g.xv,{...j.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:C.K.gray[11]},children:t?(0,D.l)(t):"-"})}},{accessorKey:"returnDate",header:"تاریخ بازگشت",cell:e=>{let t=e.getValue();return(0,n.jsx)(g.xv,{...j.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:C.K.gray[11]},children:t?(0,D.l)(t):"-"})}},{id:"details",cell:e=>{let{row:r}=e,a=r.original;return(0,n.jsx)(g.kC,{width:"100%",height:"100%",align:"center",justify:"center",children:(0,n.jsx)(g.zx,{variant:"surface",onClick:e=>{e.preventDefault(),t.push("/plans/user-plan/".concat(a.tripId))},children:"..."})})}}],data:e.data})},N=r(29962),S=r(72051),k=r(51360),K=r(86555),P=r(25231);function E(e){let{searchParams:t}=e,[r,u]=(0,a.useState)(!1),h=(0,o.NL)(),p=(0,i.cI)({defaultValues:{page:t.page?Number(t.page):1,searchQuery:t.searchQuery||"",sortDate:t.sortDate?t.sortDate:"",targetDate:t.targetDate?t.targetDate:"",userId:t.userId?Number(t.userId):"",originCityId:t.originCityId?Number(t.originCityId):"",originProvinceId:t.originProvinceId?Number(t.originProvinceId):"",destinationCityId:t.destinationCityId?Number(t.destinationCityId):"",destinationProvinceId:t.destinationProvinceId?Number(t.destinationProvinceId):"",departureDateStart:t.departureDateStart?Number(t.departureDateStart):"",departureDateEnd:t.departureDateEnd?Number(t.departureDateEnd):"",returnDateStart:t.returnDateStart?Number(t.returnDateStart):"",returnDateEnd:t.returnDateEnd?Number(t.returnDateEnd):"",sort:t.sort||""}}),{watch:x,handleSubmit:y,setValue:m}=p,{data:f,isLoading:v,isFetching:w,isError:D}=(0,l.a)({queryKey:["recent-trips"],queryFn:async()=>await (0,d.g)(x())}),C=e=>{let t=(0,c.v7)(e,!0),r=(0,P.X)(t);h.invalidateQueries({queryKey:["recent-trips"]});let n="".concat(window.location.pathname,"?").concat(r);window.history.pushState(null,"",n)};return(0,n.jsxs)(g.kC,{direction:"column",children:[(0,n.jsx)(N.default,{title:"لیست برنامه ها",isNavigation:!0}),(0,n.jsx)(g.xu,{pr:"90px",children:(0,n.jsx)(g.rj,{width:"100%",maxWidth:"1920px",mx:"auto",children:(0,n.jsx)(i.RV,{...p,children:(0,n.jsx)("form",{onSubmit:y(C),children:(0,n.jsxs)(g.rj,{width:"100%",gap:"4",p:"5",children:[(0,n.jsx)(b,{onSubmit:()=>C(x()),isOpen:r,setIsOpen:u,isPending:v||w}),D?(0,n.jsx)(g.xv,{children:"مشکلی پیش آمده لطفا مجدد تلاش نمایید"}):w||v?(0,n.jsx)(s.$j,{style:{marginInline:"auto",scale:2,marginBlock:"40px"}}):f?(0,n.jsx)(I,{data:null==f?void 0:f.latestTrips}):(0,n.jsx)(g.kC,{width:"100%",justify:"center",mt:"6",children:(0,n.jsx)(g.xv,{...j.p.title1,children:"دیتایی موجود نیست"})}),(null==f?void 0:f.latestTrips)&&(0,n.jsxs)(g.kC,{width:"100%",align:"center",justify:"between",children:[(0,n.jsx)(S.Z,{current:x("page"),total:f.totalPages,onPageChange:e=>{m("page",e),(0,K.Z)(e),C(x())}}),(0,n.jsx)(k.Z,{data:null==f?void 0:f.latestTrips,currentPage:null==f?void 0:f.currentPage,totalCount:null==f?void 0:f.totalCount})]})]})})})})})]})}},20254:function(e,t,r){"use strict";r.d(t,{X:function(){return i},g:function(){return s}});var n=r(31067),a=r(37969);let i=async e=>{try{return(await n.x.get("trips/id/".concat(e))).data}catch(e){if(e.response)throw console.error("Error:",e.response.data.message||"Server Error"),Error("Failed to fetch trip: ".concat(e.response.statusText));if(e.request)throw console.error("Network error:",e.message),Error("Network error: Unable to fetch trip data");throw console.error("Unexpected error:",e.message),Error("Unexpected error: Please try again later")}},s=async e=>{let t=(0,a.v7)(e);delete t.sort;let r=(0,a.X_)(t);return(await n.x.get("trips?limit=10&".concat(r))).data.data}},23405:function(e,t,r){"use strict";var n=r(57437),a=r(2265),i=r(39343),s=r(93191),o=r(89183),l=r(7507),c=r(27533),d=r(1845);let u=(0,a.forwardRef)((e,t)=>{let{placeholder:r,defaultValue:a,...o}=e,d=(0,s.NL)(),{setValue:u}=(0,i.Gc)();return(0,n.jsxs)(h,{...o,ref:t,height:"fit-content",children:[(0,n.jsx)(p,{...o,ref:t,placeholder:r,variant:"surface",defaultValue:a}),(0,n.jsx)(l.hU,{size:"4",variant:"soft",onClick:()=>{u("page",1),d.invalidateQueries({queryKey:["article-list"]}),d.invalidateQueries({queryKey:["user-list"]})},children:(0,n.jsx)(c.HN,{})})]})});u.displayName="CustomSearch",t.Z=u;let h=(0,o.ZP)(l.kC).withConfig({componentId:"sc-11ef2f74-0"})(["max-height:48px;align-items:center;border:1px solid ",";border-radius:12px;padding-inline-start:1rem;&:focus-within{background-color:",";box-shadow:",";border:1px solid ",";}"],d.K.gray[7],d.K.blue[2],d.i.shadow1,d.K.gray[3]),p=(0,o.ZP)(l.nv).withConfig({componentId:"sc-11ef2f74-1"})(["&.rt-TextFieldRoot:where(.rt-variant-surface){border:none;outline:none;box-shadow:none;margin-block-end:-10px;}&:focus-within{outline:none !important;border:none !important;background-color:transparent !important;box-shadow:none !important;}@media (hover:hover){background-color:transparent !important;}"])},86555:function(e,t){"use strict";t.Z=e=>{{let t=new URLSearchParams(window.location.search);t.set("page",e.toString());let r=window.location.pathname;window.history.pushState({},"","".concat(r,"?").concat(t.toString()))}}}},function(e){e.O(0,[1553,3048,3497,8334,5452,8310,6990,9212,1825,8702,9269,783,7507,7533,978,6489,2971,7023,1744],function(){return e(e.s=15849)}),_N_E=e.O()}]);