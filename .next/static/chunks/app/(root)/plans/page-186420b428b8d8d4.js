(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[166],{15849:function(e,t,r){Promise.resolve().then(r.bind(r,23315))},23315:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return T}});var n=r(57437),a=r(2265),i=r(39343),o=r(94963),s=r(93191),d=r(43767),l=r(37969),c=r(20254),u=r(16463),p=r(43397),h=r(36721),g=r(51537),x=r(7507),y=r(23405),m=r(72549),f=r(77855),v=r(82336),b=r(21949),j=r(47964),w=e=>{let{onSubmit:t,isOpen:r,setIsOpen:a,isPending:o}=e,s=(0,p.tv)(),{control:l,reset:c,setValue:w}=(0,i.Gc)(),C=(0,u.useSearchParams)(),I=e=>C.get(e)||"",{data:D}=(0,d.a)({queryKey:["constant"],queryFn:async()=>(0,h.iV)()}),N=()=>{c({page:1,searchQuery:"",sortDate:"",targetDate:"",userId:"",originCityId:"",originProvinceId:"",destinationCityId:"",destinationProvinceId:"",departureDateStart:"",departureDateEnd:"",returnDateStart:"",returnDateEnd:"",sort:""}),s.replace("/plans"),t(),a(!1)},E=e=>{switch(e){case 1:return w("sortDate","des"),w("targetDate","dep");case 2:return w("targetDate","dep"),w("sortDate","asc");case 3:return w("targetDate","ret"),w("sortDate","des");case 4:return w("targetDate","ret"),w("sortDate","asc")}};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(x.rj,{width:"100%",columns:"5",align:"center",gapX:"5",style:{gridTemplateColumns:"auto auto 2fr  1fr"},children:[(0,n.jsx)(x.hU,{type:"button",colorVariant:"BLUE",variant:"soft",size:"4",onClick:()=>a(!0),children:(0,n.jsx)(v.wn,{width:16,height:16})}),(0,n.jsx)(x.zx,{colorVariant:"BLUE",variant:"ghost",type:"button",size:"4",onClick:()=>s.push("/plans/create-plan"),style:{padding:"11.5px 16px"},children:(0,n.jsxs)(x.kC,{gap:"2",align:"center",children:[(0,n.jsx)(x.xv,{...b.p.body1,children:"+"}),(0,n.jsx)(x.xv,{...b.p.body1,children:" افزودن برنامه"})]})}),(0,n.jsx)(i.Qr,{name:"searchQuery",control:l,render:e=>{let{field:t}=e;return(0,n.jsx)(y.Z,{...t,placeholder:"جستجو",defaultValue:I("searchQuery")?I("searchQuery"):""})}}),(0,n.jsx)(i.Qr,{name:"sort",control:l,render:e=>{let{field:r}=e;return(0,n.jsx)(x.fp,{...r,placeholder:"مرتب سازی بر اساس",size:"3",value:String(r.value||I("sort")),onValueChange:e=>{let n=g.gy.find(t=>t.id===Number(e));E(null==n?void 0:n.id),r.onChange(e),t(),w("page",1)},children:g.gy.map(e=>(0,n.jsx)(x.Ql,{value:String(e.id),style:{padding:"13.5px 12px"},children:e.name},e.id))})}})]}),(0,n.jsxs)(x.u_,{isOpen:r,onClose:()=>a(!1),children:[(0,n.jsx)(f.Z,{title:"فیلتر",handleClose:()=>a(!1)}),(0,n.jsx)(j.Z,{province:(null==D?void 0:D.provinces)?D.provinces:[]}),(0,n.jsx)(m.Z,{submitButtonText:"اعمال فیلتر ها",closeButtonText:"حذف فیلتر ها",onCloseButton:()=>N(),onSubmit:()=>{t()},isLoading:o})]})]})},C=r(46302),I=r(10504),D=r(1845),N=e=>{let{push:t}=(0,p.tv)();return(0,n.jsx)(C.iA,{columns:[{accessorKey:"index",header:"ردیف",cell:e=>(0,n.jsx)(x.xv,{...b.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:D.K.gray[11]},children:e.row.index+1})},{accessorKey:"userMobile",header:"شماره کاربر",cell:e=>{let t=e.getValue();return(0,n.jsx)(x.xv,{...b.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:D.K.gray[11]},children:t||"-"})}},{accessorKey:"sourceCityName",header:"مبدا",cell:e=>{let t=e.getValue();return(0,n.jsx)(x.xv,{...b.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:D.K.gray[11]},children:t||"-"})}},{accessorKey:"destinationCity",header:"مقصد",cell:e=>{let t=e.getValue();return(0,n.jsx)(x.xv,{...b.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:D.K.gray[11]},children:t||"-"})}},{accessorKey:"departureDate",header:"تاریخ رفت",cell:e=>{let t=e.getValue();return(0,n.jsx)(x.xv,{...b.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:D.K.gray[11]},children:t?(0,I.l)(t):"-"})}},{accessorKey:"returnDate",header:"تاریخ بازگشت",cell:e=>{let t=e.getValue();return(0,n.jsx)(x.xv,{...b.p.body2,style:{display:"flex",height:"100%",alignItems:"center",color:D.K.gray[11]},children:t?(0,I.l)(t):"-"})}},{id:"details",cell:e=>{let{row:r}=e,a=r.original;return(0,n.jsx)(x.kC,{width:"100%",height:"100%",align:"center",justify:"center",children:(0,n.jsx)(x.zx,{variant:"surface",onClick:e=>{e.preventDefault(),t("/plans/user-plan/".concat(a.tripId))},children:"..."})})}}],data:e.data})},E=r(29962),k=r(72051),S=r(51360),P=r(86555),K=r(25231);function T(e){let{searchParams:t}=e,[r,u]=(0,a.useState)(!1),p=(0,s.NL)(),h=(0,i.cI)({defaultValues:{page:t.page?Number(t.page):1,searchQuery:t.searchQuery||"",sortDate:t.sortDate?t.sortDate:"",targetDate:t.targetDate?t.targetDate:"",userId:t.userId?Number(t.userId):"",originCityId:t.originCityId?Number(t.originCityId):"",originProvinceId:t.originProvinceId?Number(t.originProvinceId):"",destinationCityId:t.destinationCityId?Number(t.destinationCityId):"",destinationProvinceId:t.destinationProvinceId?Number(t.destinationProvinceId):"",departureDateStart:t.departureDateStart?Number(t.departureDateStart):"",departureDateEnd:t.departureDateEnd?Number(t.departureDateEnd):"",returnDateStart:t.returnDateStart?Number(t.returnDateStart):"",returnDateEnd:t.returnDateEnd?Number(t.returnDateEnd):"",sort:t.sort||""}}),{watch:g,handleSubmit:y,setValue:m}=h,{data:f,isLoading:v,isFetching:j,isError:C}=(0,d.a)({queryKey:["recent-trips"],queryFn:async()=>await (0,c.gG)(g())}),I=e=>{let t=(0,l.v7)(e,!0),r=(0,K.X)(t);p.invalidateQueries({queryKey:["recent-trips"]});let n="".concat(window.location.pathname,"?").concat(r);window.history.pushState(null,"",n)};return(0,n.jsxs)(x.kC,{direction:"column",children:[(0,n.jsx)(E.Z,{title:"لیست برنامه ها",isNavigation:!0}),(0,n.jsx)(x.xu,{pr:"90px",children:(0,n.jsx)(x.rj,{width:"100%",maxWidth:"1920px",mx:"auto",children:(0,n.jsx)(i.RV,{...h,children:(0,n.jsx)("form",{onSubmit:y(I),children:(0,n.jsxs)(x.rj,{width:"100%",gap:"4",p:"5",children:[(0,n.jsx)(w,{onSubmit:()=>I(g()),isOpen:r,setIsOpen:u,isPending:v||j}),C?(0,n.jsx)(x.xv,{children:"مشکلی پیش آمده لطفا مجدد تلاش نمایید"}):j||v?(0,n.jsx)(o.$j,{style:{marginInline:"auto",scale:2,marginBlock:"40px"}}):f?(0,n.jsx)(N,{data:null==f?void 0:f.latestTrips}):(0,n.jsx)(x.kC,{width:"100%",justify:"center",mt:"6",children:(0,n.jsx)(x.xv,{...b.p.title1,children:"دیتایی موجود نیست"})}),(null==f?void 0:f.latestTrips)&&(0,n.jsxs)(x.kC,{width:"100%",align:"center",justify:"between",children:[(0,n.jsx)(k.Z,{current:g("page"),total:f.totalPages,onPageChange:e=>{m("page",e),(0,P.Z)(e),I(g())}}),(0,n.jsx)(S.Z,{data:null==f?void 0:f.latestTrips,currentPage:null==f?void 0:f.currentPage,totalCount:null==f?void 0:f.totalCount})]})]})})})})})]})}},20254:function(e,t,r){"use strict";r.d(t,{Er:function(){return u},XS:function(){return d},gG:function(){return l}});var n=r(39053),a=r.n(n),i=r(15263),o=r(31067),s=r(37969);let d=async e=>{try{return(await o.x.get("trips/id/".concat(e))).data}catch(e){if(e.response)throw console.error("Error:",e.response.data.message||"Server Error"),Error("Failed to fetch trip: ".concat(e.response.statusText));if(e.request)throw console.error("Network error:",e.message),Error("Network error: Unable to fetch trip data");throw console.error("Unexpected error:",e.message),Error("Unexpected error: Please try again later")}},l=async e=>{let t=(0,s.v7)(e);delete t.sort;let r=(0,s.X_)(t);return(await o.x.get("trips?limit=10&".concat(r))).data.data};function c(e,t){let r=a().tz(e,"Asia/Tehran"),n=a().tz(t,"Asia/Tehran");return r.set({hour:n.hour(),minute:n.minute(),second:n.second(),millisecond:n.millisecond()}),r.clone().tz("UTC",!0).toISOString()}let u=async e=>{let t=new i.Z,r=Object.fromEntries(Object.entries({departureDateTime:c(new Date(e.departureDate).getTime(),new Date(e.departureTime).getTime()),returnDateTime:c(new Date(e.returnDate).getTime(),new Date(e.returnTime).getTime()),travelMode:e.isExpand?e.travelMode:void 0,accommodationType:e.isExpand?e.accommodationType:void 0,companions:e.isExpand?e.companions:void 0,popularity:e.isExpand?[e.popularity]:void 0,placeCategoryId:e.isExpand?e.placeCategoryId:void 0,adultCount:e.isExpand?Number(e.adultCount):1,childCount:e.isExpand?Number(e.childCount):0,infantCount:e.isExpand?Number(e.infantCount):void 0,destinationProvinceId:Number(e.destinationProvinceId),destinationCityId:[Number(e.destinationCityId)],sourceProvinceId:Number(e.sourceProvinceId),sourceCityId:Number(e.sourceCityId),justInside:e.justInside}).filter(e=>{let[t,r]=e;return void 0!==r&&""!==r&&"none"!==r&&null!==r&&!(Array.isArray(r)&&0===r.length)&&!(Array.isArray(r)&&r.every(e=>""===e))&&!(Array.isArray(r)&&r.every(e=>"none"===e))&&!("object"==typeof r&&null!==r&&0===Object.keys(r).length)}));return t.set("ticketData",r),(await o.x.post("trips",r)).data.data}},68672:function(e,t,r){"use strict";r.d(t,{SP:function(){return o},yM:function(){return s}});var n=r(89183),a=r(1845),i=r(7507);(0,n.zo)(i.kC).withConfig({componentId:"sc-2ff6b81e-0"})(["padding:2px 12px;border-radius:8px;background-color:",";font-size:10px;align-items:center;"],a.K.gray[3]),n.zo.div.withConfig({componentId:"sc-2ff6b81e-1"})(["height:0.1px;border-top:",";width:-webkit-fill-available;opacity:30%;"],e=>{let{color:t}=e;return t?"1px dashed ".concat(t):"1px dashed ".concat(a.K.gray[12])});let o=(0,n.zo)(i.kC).withConfig({componentId:"sc-2ff6b81e-2"})(["max-height:48px;align-items:center;border:1px solid ",";border-radius:12px;&:focus-within{background-color:",";box-shadow:",";border:1px solid ",";}"],a.K.gray[7],a.K.blue[2],a.i.shadow1,a.K.gray[3]),s=(0,n.zo)(i.nv).withConfig({componentId:"sc-2ff6b81e-3"})(["&.rt-TextFieldRoot:where(.rt-variant-surface){border:none;outline:none;box-shadow:none;margin-block-end:-10px;background-color:transparent !important;}&:focus-within{outline:none !important;border:none !important;background-color:transparent !important;box-shadow:none !important;}@media (hover:hover){background-color:transparent !important;}"])},23405:function(e,t,r){"use strict";var n=r(57437),a=r(2265),i=r(39343),o=r(93191),s=r(7507),d=r(82336),l=r(68672);let c=(0,a.forwardRef)((e,t)=>{let{placeholder:r,defaultValue:a,...c}=e,u=(0,o.NL)(),{setValue:p}=(0,i.Gc)();return(0,n.jsxs)(l.SP,{...c,ref:t,height:"fit-content",children:[(0,n.jsx)(l.yM,{...c,ref:t,placeholder:r,variant:"surface",defaultValue:a}),(0,n.jsx)(s.hU,{size:"4",variant:"soft",onClick:()=>{p("page",1),u.invalidateQueries({queryKey:["article-list"]}),u.invalidateQueries({queryKey:["user-list"]})},children:(0,n.jsx)(d.HN,{})})]})});c.displayName="CustomSearch",t.Z=c},86555:function(e,t){"use strict";t.Z=e=>{{let t=new URLSearchParams(window.location.search);t.set("page",e.toString());let r=window.location.pathname;window.history.pushState({},"","".concat(r,"?").concat(t.toString()))}}}},function(e){e.O(0,[1553,3048,3497,8334,5452,8310,6990,9212,7326,1825,8702,3397,9269,783,3734,7507,2336,9824,6489,2971,7023,1744],function(){return e(e.s=15849)}),_N_E=e.O()}]);